const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web3-30Ii_1H8.js","assets/vendor-B0r8BCsL.js","assets/react-CnjVYTDc.js","assets/ui-BQCqNqg0.js","assets/utils-BkLtITBR.js"])))=>i.map(i=>d[i]);
import{r as f,j as e,a9 as $,aX as Z,ag as ee,ad as H,L as te,ai as Y,b8 as se,F as ae,ae as ne}from"./react-CnjVYTDc.js";import{T as ie,a as re,b as L,c as B}from"./tabs-1rBqboxz.js";import{S as ce}from"./vendor-B0r8BCsL.js";import{C as le,c as oe,f as g,p as I,w as S,d as O}from"./web3-30Ii_1H8.js";import{C as u,b as h,c as x,a as m,B as y,D as de,p as ue,h as he,i as xe,j as me,A as pe,k as ge,d as b,u as fe,g as _}from"./index-DxHLzNoH.js";import{I as je}from"./input-BJWVzqi3.js";import{L as w}from"./label-Cv6fFAQ8.js";import{S as ve,a as Se,b as we,c as ye,d as E}from"./select-CKrfnZoO.js";import{W as ke}from"./WalletSelector-Bly2x6nt.js";import"./ui-BQCqNqg0.js";import"./utils-BkLtITBR.js";import"./router-B_5Dh3-u.js";const Ne=["function name() view returns (string)","function symbol() view returns (string)","function decimals() view returns (uint8)","function totalSupply() view returns (uint256)","function balanceOf(address) view returns (uint256)","function transfer(address to, uint256 amount) returns (bool)","function allowance(address owner, address spender) view returns (uint256)","function approve(address spender, uint256 amount) returns (bool)","function calculateFeeDiscount(address user) view returns (uint256)","function getEffectiveFee(address user, uint256 baseFee) view returns (uint256)","function stakeTokens(uint256 amount, uint256 lockPeriod)","function claimStakingRewards()","function emergencyWithdraw()","function calculateStakingRewards(address user) view returns (uint256)","function getUserStakingInfo(address user) view returns (uint256, uint256, uint256, uint256, uint256)","function getTokenInfo() view returns (uint256, uint256, uint256, uint256)","event Transfer(address indexed from, address indexed to, uint256 value)","event Approval(address indexed owner, address indexed spender, uint256 value)","event StakingReward(address indexed user, uint256 amount)","event EmergencyWithdraw(address indexed user, uint256 amount, uint256 penalty)"];class T{constructor(){this.provider=null,this.contract=null,this.signer=null}async initialize(t,s){this.provider=t,this.signer=s||null,this.contract=new le(oe.XPSToken,Ne,t)}async getBalance(t){if(!this.contract)throw new Error("XPS service not initialized");const s=await this.contract.balanceOf(t);return g(s)}async getTotalSupply(){if(!this.contract)throw new Error("XPS service not initialized");const t=await this.contract.totalSupply();return g(t)}async getTokenInfo(){if(!this.contract)throw new Error("XPS service not initialized");const[t,s,i,r]=await this.contract.getTokenInfo();return{totalSupply:g(t),totalBurned:g(s),circulatingSupply:g(i),protocolRevenue:g(r)}}async calculateFeeDiscount(t){if(!this.contract)throw new Error("XPS service not initialized");const s=await this.contract.calculateFeeDiscount(t);return Number(s)}async getEffectiveFee(t,s){if(!this.contract)throw new Error("XPS service not initialized");const i=await this.calculateFeeDiscount(t),r=await this.contract.getEffectiveFee(t,s);return{discount:Number(i),effectiveFee:Number(r)}}async stakeTokens(t,s){if(!this.contract||!this.signer)throw new Error("XPS service not initialized or no signer");const i=this.contract.connect(this.signer),r=I(t);return(await i.stakeTokens(r,s)).hash}async claimStakingRewards(){if(!this.contract||!this.signer)throw new Error("XPS service not initialized or no signer");return(await this.contract.connect(this.signer).claimStakingRewards()).hash}async emergencyWithdraw(){if(!this.contract||!this.signer)throw new Error("XPS service not initialized or no signer");return(await this.contract.connect(this.signer).emergencyWithdraw()).hash}async getUserStakingInfo(t){if(!this.contract)throw new Error("XPS service not initialized");const[s,i,r,o,X]=await this.contract.getUserStakingInfo(t);return{stakedAmount:g(s),stakingDuration:i.toString(),pendingRewards:g(r),lockPeriod:o.toString(),feeDiscount:X.toString()}}async calculateStakingRewards(t){if(!this.contract)throw new Error("XPS service not initialized");const s=await this.contract.calculateStakingRewards(t);return g(s)}async transfer(t,s){if(!this.contract||!this.signer)throw new Error("XPS service not initialized or no signer");const i=this.contract.connect(this.signer),r=I(s);return(await i.transfer(t,r)).hash}async approve(t,s){if(!this.contract||!this.signer)throw new Error("XPS service not initialized or no signer");const i=this.contract.connect(this.signer),r=I(s);return(await i.approve(t,r)).hash}async getAllowance(t,s){if(!this.contract)throw new Error("XPS service not initialized");const i=await this.contract.allowance(t,s);return g(i)}static formatFeeDiscount(t){return`${(t/100).toFixed(1)}%`}static getFeeDiscountTier(t){return t>=1e5?{tier:"Platinum",discount:7500}:t>=5e4?{tier:"Gold",discount:5e3,nextTier:{amount:1e5,discount:7500}}:t>=1e4?{tier:"Silver",discount:3e3,nextTier:{amount:5e4,discount:5e3}}:t>=5e3?{tier:"Bronze",discount:2e3,nextTier:{amount:1e4,discount:3e3}}:t>=1e3?{tier:"Basic",discount:1e3,nextTier:{amount:5e3,discount:2e3}}:{tier:"None",discount:0,nextTier:{amount:1e3,discount:1e3}}}static getStakingMultiplier(t){return t>=365?4:t>=180?2.5:t>=90?1.5:1}static formatStakingDuration(t){const s=Math.floor(t/86400),i=Math.floor(t%86400/3600);return s>0?`${s}d ${i}h`:`${i}h`}}const A=new T;typeof window<"u"&&window.ethereum&&ce(()=>import("./web3-30Ii_1H8.js").then(a=>a.e),__vite__mapDeps([0,1,2,3,4])).then(async({web3Service:a})=>{try{await a.initializeProvider(),a.provider&&await A.initialize(a.provider)}catch(t){console.debug("XPS service auto-initialization failed:",t)}});function Pe({stakingInfo:a,xpsBalance:t,loading:s,onStake:i,onClaimRewards:r,onEmergencyWithdraw:o,getStakingMultiplier:X,formatDuration:F}){const[j,d]=f.useState(""),[k,R]=f.useState("30"),[c,N]=f.useState(!1),W=async()=>{!j||parseFloat(j)<=0||parseFloat(j)>parseFloat(t)||(await i(j,k),d(""),N(!1))};return e.jsxs(u,{children:[e.jsx(h,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5 text-blue-500"}),"Stake XPS Tokens"]})}),e.jsx(m,{className:"space-y-4",children:a&&parseFloat(a.stakedAmount)>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(w,{children:"Staked Amount"}),e.jsxs("p",{className:"text-2xl font-bold",children:[parseFloat(a.stakedAmount).toLocaleString()," XPS"]})]}),e.jsxs("div",{children:[e.jsx(w,{children:"Lock Period"}),e.jsxs("p",{className:"text-lg",children:[a.lockPeriod," days"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(w,{children:"Staking Duration"}),e.jsx("p",{className:"text-lg",children:F(parseInt(a.stakingDuration))})]}),e.jsxs("div",{children:[e.jsx(w,{children:"Pending Rewards"}),e.jsxs("p",{className:"text-lg font-semibold text-green-500",children:[parseFloat(a.pendingRewards).toLocaleString()," XPS"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:r,disabled:s||parseFloat(a.pendingRewards)===0,children:s?"Processing...":"Claim Rewards"}),e.jsx(y,{variant:"destructive",onClick:o,disabled:s,children:s?"Processing...":"Emergency Withdraw (25% penalty)"})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"You have no staked XPS tokens"}),e.jsxs(de,{open:c,onOpenChange:N,children:[e.jsx(ue,{asChild:!0,children:e.jsx(y,{children:"Start Staking"})}),e.jsxs(he,{children:[e.jsx(xe,{children:e.jsx(me,{children:"Stake XPS Tokens"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(w,{htmlFor:"stake-amount",children:"Amount to Stake"}),e.jsx(je,{id:"stake-amount",type:"number",placeholder:"Enter amount",value:j,onChange:z=>d(z.target.value),max:t}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Available: ",parseFloat(t).toLocaleString()," XPS"]})]}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"lock-period",children:"Lock Period"}),e.jsxs(ve,{value:k,onValueChange:R,children:[e.jsx(Se,{children:e.jsx(we,{placeholder:"Select lock period"})}),e.jsxs(ye,{children:[e.jsx(E,{value:"30",children:"30 days (1.0x multiplier)"}),e.jsx(E,{value:"90",children:"90 days (1.5x multiplier)"}),e.jsx(E,{value:"180",children:"180 days (2.5x multiplier)"}),e.jsx(E,{value:"365",children:"365 days (4.0x multiplier)"})]})]})]}),e.jsxs(pe,{children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsxs(ge,{children:["Staking APY: ",(100*X(parseInt(k))).toFixed(0),"% | Emergency withdrawal has 25% penalty"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:W,disabled:s,children:s?"Processing...":"Stake Tokens"}),e.jsx(y,{variant:"outline",onClick:()=>N(!1),children:"Cancel"})]})]})]})]})]})})]})}function be({xpsBalance:a,stakingInfo:t}){const i=(r=>{const o=r+parseFloat(t?.stakedAmount||"0");return T.getFeeDiscountTier(o)})(parseFloat(a));return e.jsxs(u,{children:[e.jsx(h,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5 text-yellow-500"}),"XPS Token Overview"]})}),e.jsx(m,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Supply"}),e.jsx("p",{className:"text-lg font-semibold",children:"1,000,000,000 XPS"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Burned"}),e.jsx("p",{className:"text-lg font-semibold text-red-500",children:"0 XPS"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your Balance"}),e.jsxs("p",{className:"text-lg font-semibold text-green-500",children:[parseFloat(a).toLocaleString()," XPS"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Fee Discount"}),e.jsxs(b,{variant:i.discount>0?"default":"secondary",children:[i.tier," - ",T.formatFeeDiscount(i.discount)]})]})]})})]})}function Te({xpsBalance:a,stakingInfo:t}){const s=[{tier:"Basic",amount:1e3,discount:10},{tier:"Bronze",amount:5e3,discount:20},{tier:"Silver",amount:1e4,discount:30},{tier:"Gold",amount:5e4,discount:50},{tier:"Platinum",amount:1e5,discount:75}],i=parseFloat(a)+parseFloat(t?.stakedAmount||"0");return e.jsxs(u,{children:[e.jsx(h,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-5 w-5 text-green-500"}),"Fee Discount Tiers"]})}),e.jsx(m,{children:e.jsx("div",{className:"space-y-4",children:s.map(r=>{const o=i>=r.amount&&(r.tier==="Platinum"||i<([5e3,1e4,5e4,1e5][["Bronze","Silver","Gold","Platinum"].indexOf(r.tier)]||1/0));return e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${o?"border-blue-500 bg-blue-50 dark:bg-blue-950":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{variant:o?"default":"secondary",children:r.tier}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[r.amount.toLocaleString()," XPS"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.discount,"% fee discount"]})]})]}),o&&e.jsx(b,{variant:"default",children:"Current"})]},r.tier)})})})]})}function Xe({stakingAnalytics:a,analyticsLoading:t,userAddress:s}){return t?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(te,{className:"h-6 w-6 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading analytics..."})]}):a?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(u,{children:[e.jsx(h,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-purple-500"}),"Staking Analytics"]})}),e.jsx(m,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Staked"}),e.jsxs("span",{className:"font-semibold",children:[a.totalStaked.toLocaleString()," XPS"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Active Stakings"}),e.jsx("span",{className:"font-semibold",children:a.activeStakings})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Rewards"}),e.jsxs("span",{className:"font-semibold text-green-500",children:[a.totalRewards.toLocaleString()," XPS"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Average APY"}),e.jsxs("span",{className:"font-semibold text-blue-500",children:[a.averageAPY.toFixed(0),"%"]})]})]})})]}),e.jsxs(u,{children:[e.jsx(h,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5 text-orange-500"}),"Active Positions"]})}),e.jsx(m,{children:a.summary.activePeriods.length>0?e.jsx("div",{className:"space-y-3",children:a.summary.activePeriods.map((i,r)=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[i.amount.toLocaleString()," XPS"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[i.lockPeriod,"d @ ",i.apy,"% APY"]})]}),e.jsxs(b,{variant:"outline",children:[i.estimatedRewards.toLocaleString()," XPS"]})]},r))}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"No active staking positions"})})})]})]}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"No staking analytics available"})})}function Fe({userAddress:a,loading:t,isWalletSelectorOpen:s,setIsWalletSelectorOpen:i,onConnectWallet:r}){return a?null:e.jsxs(e.Fragment,{children:[e.jsxs(u,{children:[e.jsx(h,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-blue-500"}),"Connect Your Wallet"]})}),e.jsxs(m,{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Connect your wallet to start staking XPS tokens"}),e.jsx(y,{onClick:()=>i(!0),disabled:t,children:t?"Connecting...":"Connect Wallet"})]})]}),e.jsx(ke,{isOpen:s,onClose:()=>i(!1)})]})}function Ce(){const[a,t]=f.useState(""),[s,i]=f.useState("0"),[r,o]=f.useState(null),[X,F]=f.useState(null),[j,d]=f.useState(!1),[k,R]=f.useState(!1),{toast:c}=fe(),{data:N,isLoading:W}=ae({queryKey:["/api/xps/staking-analytics",a],enabled:!!a,refetchInterval:3e4});f.useEffect(()=>{z()},[]);const z=async()=>{try{S.provider&&(await A.initialize(S.provider),await C(),await U())}catch(n){console.error("Failed to initialize XPS services:",n)}},C=async()=>{try{if(!S.provider){console.log("Web3 provider not available");return}const n=await S.getAccount();if(!n){console.log("No wallet connected");return}t(n);const p=await S.checkXPSBalance(n);i(p);const l=await O.getStakingInfoDirect(n);if(l){const P=l.unlockTime*1e3,v=l.lockPeriod>=365?400:l.lockPeriod>=180?250:l.lockPeriod>=90?150:100,D={totalStaked:l.stakedAmount,availableRewards:l.rewards,lockPeriod:l.lockPeriod,unlockDate:P,apy:v,multiplier:l.lockPeriod>=365?4:l.lockPeriod>=180?2.5:l.lockPeriod>=90?1.5:1};o(D)}else{const P={totalStaked:"0",availableRewards:"0",lockPeriod:30,unlockDate:Date.now()+2592e6,apy:100,multiplier:1};o(P)}}catch(n){console.error("Failed to load user data:",n)}},U=async()=>{try{const n=await A.getTokenInfo();F(n)}catch(n){console.error("Failed to load token info:",n)}},M=async(n,p)=>{if(!n||parseFloat(n)<=0){c({title:"Ïò§Î•ò",description:"Ïú†Ìö®Ìïú Ïä§ÌÖåÏù¥ÌÇπ ÏàòÎüâÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.",variant:"destructive"});return}if(!a){c({title:"ÏßÄÍ∞ë Ïó∞Í≤∞ ÌïÑÏöî",description:"ÏßÄÍ∞ëÏùÑ Î®ºÏ†Ä Ïó∞Í≤∞Ìï¥Ï£ºÏÑ∏Ïöî.",variant:"destructive"});return}const l=parseFloat(n),P=parseFloat(s);if(l>P){c({title:"ÏûîÏï° Î∂ÄÏ°±",description:"XPS ÌÜ†ÌÅ∞ ÏûîÏï°Ïù¥ Î∂ÄÏ°±Ìï©ÎãàÎã§.",variant:"destructive"});return}try{d(!0),c({title:"Ïä§ÌÖåÏù¥ÌÇπ ÏßÑÌñâ Ï§ë",description:"XPS ÌÜ†ÌÅ∞ Ïä§ÌÖåÏù¥ÌÇπÏù¥ ÏßÑÌñâ Ï§ëÏûÖÎãàÎã§. Î©îÌÉÄÎßàÏä§ÌÅ¨ÏóêÏÑú Í±∞ÎûòÎ•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî."});const v=await O.stakeXPSDirect(n,parseInt(p));if(v.success){const D=await fetch(_("/api/xps/stake"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({walletAddress:a,amount:n,lockPeriod:parseInt(p),transactionHash:v.transactionHash})});if(D.ok)c({title:"Ïä§ÌÖåÏù¥ÌÇπ ÏôÑÎ£å! üéâ",description:`${n} XPSÍ∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ${p}ÏùºÍ∞Ñ Ïä§ÌÖåÏù¥ÌÇπÎêòÏóàÏäµÎãàÎã§.`}),await C();else{const Q=await D.json();c({title:"Ïä§ÌÖåÏù¥ÌÇπ Í∏∞Î°ù Ïã§Ìå®",description:Q.error||"Ïä§ÌÖåÏù¥ÌÇπ Í∏∞Î°ù Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.",variant:"destructive"})}}else c({title:"Ïä§ÌÖåÏù¥ÌÇπ Ïã§Ìå®",description:v.error||"Ïä§ÌÖåÏù¥ÌÇπ Ïã§Ìñâ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.",variant:"destructive"})}catch(v){console.error("Staking failed:",v),c({title:"Ïä§ÌÖåÏù¥ÌÇπ Ïã§Ìå®",description:"Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.",variant:"destructive"})}finally{d(!1)}},G=async()=>{try{d(!0);const n=await S.connectWallet();if(n){t(n);try{const l=await S.checkXPSBalance(n);i(l)}catch(l){console.error("Failed to load XPS balance:",l),i("0")}F({totalSupply:"1000000000",totalBurned:"0",circulatingSupply:"1000000000",priceUSD:"1.0",marketCap:"1000000000"});const p={totalStaked:"0",availableRewards:"0.1",lockPeriod:30,unlockDate:Date.now()+720*60*60*1e3,apy:100,multiplier:1};o(p),c({title:"ÏßÄÍ∞ë Ïó∞Í≤∞ ÏôÑÎ£å",description:"ÏßÄÍ∞ëÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ïó∞Í≤∞ÎêòÏóàÏäµÎãàÎã§."})}}catch(n){console.error("Wallet connection failed:",n),c({title:"ÏßÄÍ∞ë Ïó∞Í≤∞ Ïã§Ìå®",description:"ÏßÄÍ∞ë Ïó∞Í≤∞ÏùÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.",variant:"destructive"})}finally{d(!1)}},V=async()=>{if(!a){c({title:"ÏßÄÍ∞ë Ïó∞Í≤∞ ÌïÑÏöî",description:"ÏßÄÍ∞ëÏùÑ Î®ºÏ†Ä Ïó∞Í≤∞Ìï¥Ï£ºÏÑ∏Ïöî.",variant:"destructive"});return}if(!r||parseFloat(r.availableRewards)<=0){c({title:"Î≥¥ÏÉÅ ÏóÜÏùå",description:"ÌÅ¥Î†àÏûÑ Í∞ÄÎä•Ìïú Î≥¥ÏÉÅÏù¥ ÏóÜÏäµÎãàÎã§.",variant:"destructive"});return}try{d(!0),c({title:"Î≥¥ÏÉÅ ÌÅ¥Î†àÏûÑ ÏßÑÌñâ Ï§ë",description:"XPS Ïä§ÌÖåÏù¥ÌÇπ Î≥¥ÏÉÅÏùÑ ÌÅ¥Î†àÏûÑÌïòÍ≥† ÏûàÏäµÎãàÎã§. Î©îÌÉÄÎßàÏä§ÌÅ¨ÏóêÏÑú Í±∞ÎûòÎ•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî."});const n=await O.claimRewardsDirect();if(n.success){const p=await fetch(_("/api/xps/claim-rewards"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({walletAddress:a,rewardAmount:r.availableRewards,transactionHash:n.transactionHash})});if(p.ok)c({title:"Î≥¥ÏÉÅ ÌÅ¥Î†àÏûÑ ÏôÑÎ£å! üéâ",description:`${r.availableRewards} XPS Î≥¥ÏÉÅÏù¥ ÌåêÎß§Ïûê ÏßÄÍ∞ëÏóêÏÑú Ï†ÑÏÜ°ÎêòÏóàÏäµÎãàÎã§.`}),await C();else{const l=await p.json();c({title:"Î≥¥ÏÉÅ ÌÅ¥Î†àÏûÑ Í∏∞Î°ù Ïã§Ìå®",description:l.error||"Î≥¥ÏÉÅ ÌÅ¥Î†àÏûÑ Í∏∞Î°ù Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.",variant:"destructive"})}}else c({title:"Î≥¥ÏÉÅ ÌÅ¥Î†àÏûÑ Ïã§Ìå®",description:n.error||"Î≥¥ÏÉÅ ÌÅ¥Î†àÏûÑ Ïã§Ìñâ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.",variant:"destructive"})}catch(n){console.error("Reward claim failed:",n),c({title:"Î≥¥ÏÉÅ ÌÅ¥Î†àÏûÑ Ïã§Ìå®",description:"Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.",variant:"destructive"})}finally{d(!1)}},q=async()=>{d(!0);try{const n=await A.emergencyWithdraw();c({title:"Emergency Withdrawal Processed",description:`Transaction hash: ${n.slice(0,10)}... (25% penalty applied)`,variant:"destructive"}),await C()}catch(n){console.error("Emergency withdraw failed:",n),c({title:"Emergency Withdrawal Failed",description:"Please try again or check your wallet connection.",variant:"destructive"})}finally{d(!1)}},J=n=>T.getStakingMultiplier(n),K=n=>T.formatStakingDuration(n);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Fe,{userAddress:a,loading:j,isWalletSelectorOpen:k,setIsWalletSelectorOpen:R,onConnectWallet:G}),a&&e.jsxs(e.Fragment,{children:[e.jsx(be,{xpsBalance:s,stakingInfo:r}),e.jsxs(ie,{defaultValue:"stake",className:"w-full",children:[e.jsxs(re,{className:"grid w-full grid-cols-3",children:[e.jsx(L,{value:"stake",children:"Stake XPS"}),e.jsx(L,{value:"rewards",children:"Rewards"}),e.jsx(L,{value:"analytics",children:"Analytics"})]}),e.jsx(B,{value:"stake",className:"space-y-4",children:e.jsx(Pe,{stakingInfo:r,xpsBalance:s,loading:j,onStake:M,onClaimRewards:V,onEmergencyWithdraw:q,getStakingMultiplier:J,formatDuration:K})}),e.jsx(B,{value:"rewards",className:"space-y-4",children:e.jsx(Te,{xpsBalance:s,stakingInfo:r})}),e.jsx(B,{value:"analytics",className:"space-y-4",children:e.jsx(Xe,{stakingAnalytics:N,analyticsLoading:W,userAddress:a})})]})]})]})}function $e(){return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(ne,{className:"h-8 w-8 text-yellow-500"}),e.jsx("h1",{className:"text-3xl font-bold",children:"XPS Staking"}),e.jsx(b,{variant:"default",children:"Native Token"})]}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Stake XPS tokens to earn rewards and unlock premium trading features with fee discounts"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs(u,{children:[e.jsx(h,{className:"pb-3",children:e.jsxs(x,{className:"flex items-center gap-2 text-lg",children:[e.jsx(H,{className:"h-5 w-5 text-green-500"}),"Earn Rewards"]})}),e.jsx(m,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Stake XPS tokens to earn up to 400% APY based on your lock period. Longer locks provide higher multipliers."})})]}),e.jsxs(u,{children:[e.jsx(h,{className:"pb-3",children:e.jsxs(x,{className:"flex items-center gap-2 text-lg",children:[e.jsx(Y,{className:"h-5 w-5 text-blue-500"}),"Fee Discounts"]})}),e.jsx(m,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Get up to 75% discount on trading fees based on your total XPS holdings (wallet + staked balance)."})})]}),e.jsxs(u,{children:[e.jsx(h,{className:"pb-3",children:e.jsxs(x,{className:"flex items-center gap-2 text-lg",children:[e.jsx($,{className:"h-5 w-5 text-purple-500"}),"Deflationary"]})}),e.jsx(m,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"40% of protocol revenue is used to buy back and burn XPS tokens, creating deflationary pressure."})})]})]}),e.jsx(Ce,{}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(u,{children:[e.jsx(h,{children:e.jsx(x,{children:"Staking Mechanics"})}),e.jsxs(m,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"Lock Period Multipliers:"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"‚Ä¢ 30 days: 1.0x (100% APY)"}),e.jsx("li",{children:"‚Ä¢ 90 days: 1.5x (150% APY)"}),e.jsx("li",{children:"‚Ä¢ 180 days: 2.5x (250% APY)"}),e.jsx("li",{children:"‚Ä¢ 365 days: 4.0x (400% APY)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"Emergency Withdrawal:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"You can withdraw staked tokens anytime but with a 25% penalty. Penalty tokens are burned, contributing to deflation."})]})]})]}),e.jsxs(u,{children:[e.jsx(h,{children:e.jsx(x,{children:"Fee Discount Tiers"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"Tier Requirements:"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"‚Ä¢ Basic: 1,000 XPS (10% discount)"}),e.jsx("li",{children:"‚Ä¢ Bronze: 5,000 XPS (20% discount)"}),e.jsx("li",{children:"‚Ä¢ Silver: 10,000 XPS (30% discount)"}),e.jsx("li",{children:"‚Ä¢ Gold: 50,000 XPS (50% discount)"}),e.jsx("li",{children:"‚Ä¢ Platinum: 100,000 XPS (75% discount)"})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Balance calculation includes both wallet and staked tokens."})]})})]})]})]})}export{$e as default};
