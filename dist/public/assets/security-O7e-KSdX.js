import{j as e,r as w}from"./react-B-ht5LAu.js";import{C as m,c as h,f as c,u as F,d as f,e as k,B as y,D as _,j as T,k as D,l as E,i as O,b as v,g as p}from"./index-CunMlly4.js";import{P as U}from"./progress-BFBbhD-f.js";import{u as N,m as q,C as I,a2 as B,T as u,Y as R,ah as C,_ as S,p as K,ao as A,N as L}from"./utils-B8vuxRvf.js";import{U as W,V as $,W as P,X as z,Y as M,Z as V,$ as b}from"./vendor-CEoFgRlV.js";import"./router-QSY63kmV.js";import"./ui-CRT7ecel.js";import"./web3-C8Lu7bQ_.js";function X({securityStatus:a,threatsBlocked:l,systemsOnline:o}){const n=d=>{switch(d){case"secure":return"text-green-500";case"warning":return"text-yellow-500";case"critical":return"text-red-500";default:return"text-gray-500"}},i=d=>{switch(d){case"secure":return"bg-green-100 text-green-800 border-green-200";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"critical":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(m,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-3 rounded-full ${a?.overall==="secure"?"bg-green-500/20":a?.overall==="warning"?"bg-yellow-500/20":"bg-red-500/20"}`,children:e.jsx(N,{className:`w-6 h-6 ${n(a?.overall||"secure")}`})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:"Security Status"}),e.jsx(c,{className:i(a?.overall||"secure"),children:a?.overall?.toUpperCase()||"SECURE"})]})]})})}),e.jsx(m,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:e.jsxs(h,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-blue-500/20",children:e.jsx(q,{className:"w-6 h-6 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:"Security Score"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:[a?.score||0,"/100"]})]})]}),e.jsx(U,{value:a?.score||0,className:"mt-3 h-2"})]})}),e.jsx(m,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-green-500/20",children:e.jsx(I,{className:"w-6 h-6 text-green-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:"Threats Blocked"}),e.jsx("div",{className:"text-2xl font-bold text-green-400",children:l.toLocaleString()})]})]})})}),e.jsx(m,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-purple-500/20",children:e.jsx(B,{className:"w-6 h-6 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:"Systems Online"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:[o,"/8"]})]})]})})})]})}function Y({alerts:a,onResolveAlert:l}){const[o,n]=w.useState(!1),{toast:i}=F(),d=s=>{switch(s){case"low":return e.jsx(C,{className:"w-4 h-4 text-blue-500"});case"medium":return e.jsx(u,{className:"w-4 h-4 text-yellow-500"});case"high":return e.jsx(S,{className:"w-4 h-4 text-orange-500"});case"critical":return e.jsx(S,{className:"w-4 h-4 text-red-500"});default:return e.jsx(C,{className:"w-4 h-4 text-gray-500"})}},t=s=>{switch(s){case"low":return"bg-blue-100 text-blue-800 border-blue-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"critical":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},x=async s=>{try{await l(s),i({title:"Alert Resolved",description:"Security alert has been successfully resolved."})}catch{i({title:"Error",description:"Failed to resolve alert. Please try again.",variant:"destructive"})}};return e.jsxs(e.Fragment,{children:[e.jsxs(m,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:[e.jsxs(f,{className:"flex flex-row items-center justify-between",children:[e.jsxs(k,{className:"text-white flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5"}),"Security Alerts"]}),e.jsx(y,{variant:"outline",size:"sm",onClick:()=>n(!0),className:"bg-transparent border-white/20 text-white hover:bg-white/10",children:"View All"})]}),e.jsx(h,{className:"space-y-3",children:a?.slice(0,5).map(s=>e.jsx("div",{className:"p-3 bg-black/20 rounded-lg border border-white/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[d(s.severity),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-white font-medium",children:s.title}),e.jsx("div",{className:"text-gray-300 text-sm",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(c,{variant:"secondary",className:"text-xs",children:s.source}),e.jsx(c,{className:`text-xs ${t(s.severity)}`,children:s.severity.toUpperCase()}),e.jsxs("span",{className:"text-gray-400 text-xs flex items-center gap-1",children:[e.jsx(R,{className:"w-3 h-3"}),new Date(s.timestamp).toLocaleTimeString()]})]})]}),s.action_required&&!s.resolved&&e.jsx(y,{size:"sm",onClick:()=>x(s.id),className:"bg-blue-500 hover:bg-blue-600",children:"Resolve"})]})},s.id))})]}),e.jsx(_,{open:o,onOpenChange:n,children:e.jsxs(T,{className:"max-w-4xl max-h-[80vh] overflow-y-auto bg-gray-900 border-gray-700",children:[e.jsx(D,{children:e.jsxs(E,{className:"text-white flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5"}),"All Security Alerts"]})}),e.jsx("div",{className:"space-y-4",children:a?.map(s=>e.jsx("div",{className:"p-4 bg-black/20 rounded-lg border border-white/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[d(s.severity),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-white font-medium",children:s.title}),e.jsx(c,{className:t(s.severity),children:s.severity.toUpperCase()}),s.resolved&&e.jsx(c,{className:"bg-green-100 text-green-800",children:"RESOLVED"})]}),e.jsx("div",{className:"text-gray-300 text-sm mb-3",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(c,{variant:"secondary",className:"text-xs",children:s.source}),e.jsx("span",{className:"text-gray-400 text-xs",children:new Date(s.timestamp).toLocaleString()})]}),s.affected_components&&s.affected_components.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Affected Components:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.affected_components.map((g,r)=>e.jsx(c,{variant:"outline",className:"text-xs",children:g},r))})]}),s.resolution_steps&&s.resolution_steps.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Resolution Steps:"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-300",children:s.resolution_steps.map((g,r)=>e.jsx("li",{children:g},r))})]})]}),s.action_required&&!s.resolved&&e.jsx(y,{size:"sm",onClick:()=>x(s.id),className:"bg-blue-500 hover:bg-blue-600",children:"Resolve"})]})},s.id))})]})})]})}function H({metrics:a,selectedTimeframe:l,onTimeframeChange:o}){const n=["1h","24h","7d","30d"];return e.jsxs(m,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:[e.jsxs(f,{className:"flex flex-row items-center justify-between",children:[e.jsxs(k,{className:"text-white flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5"}),"Security Metrics"]}),e.jsx("div",{className:"flex gap-2",children:n.map(i=>e.jsx(y,{variant:l===i?"default":"outline",size:"sm",onClick:()=>o(i),className:l===i?"bg-purple-500 hover:bg-purple-600":"bg-transparent border-white/20 text-white hover:bg-white/10",children:i},i))})]}),e.jsx(h,{children:e.jsx("div",{className:"h-64",children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs($,{data:a,children:[e.jsx(P,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(z,{dataKey:"timestamp",stroke:"#9CA3AF"}),e.jsx(M,{stroke:"#9CA3AF"}),e.jsx(V,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"8px",color:"#F9FAFB"}}),e.jsx(b,{type:"monotone",dataKey:"threats_blocked",stroke:"#10B981",strokeWidth:2,name:"Threats Blocked"}),e.jsx(b,{type:"monotone",dataKey:"security_score",stroke:"#3B82F6",strokeWidth:2,name:"Security Score"}),e.jsx(b,{type:"monotone",dataKey:"suspicious_activity",stroke:"#F59E0B",strokeWidth:2,name:"Suspicious Activity"}),e.jsx(b,{type:"monotone",dataKey:"failed_attempts",stroke:"#EF4444",strokeWidth:2,name:"Failed Attempts"}),e.jsx(b,{type:"monotone",dataKey:"successful_defenses",stroke:"#8B5CF6",strokeWidth:2,name:"Successful Defenses"})]})})})})]})}function G({threatData:a}){const[l,o]=w.useState(!1),n=t=>{switch(t){case"low":return"bg-blue-100 text-blue-800 border-blue-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"critical":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},i=t=>{switch(t){case"active":return"bg-red-100 text-red-800 border-red-200";case"mitigated":return"bg-green-100 text-green-800 border-green-200";case"investigating":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},d=t=>{switch(t){case"low":return e.jsx(N,{className:"w-4 h-4 text-blue-500"});case"medium":return e.jsx(u,{className:"w-4 h-4 text-yellow-500"});case"high":return e.jsx(u,{className:"w-4 h-4 text-orange-500"});case"critical":return e.jsx(u,{className:"w-4 h-4 text-red-500"});default:return e.jsx(N,{className:"w-4 h-4 text-gray-500"})}};return e.jsxs(e.Fragment,{children:[e.jsxs(m,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:[e.jsxs(f,{className:"flex flex-row items-center justify-between",children:[e.jsxs(k,{className:"text-white flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5"}),"Threat Intelligence"]}),e.jsx(y,{variant:"outline",size:"sm",onClick:()=>o(!0),className:"bg-transparent border-white/20 text-white hover:bg-white/10",children:"View Details"})]}),e.jsx(h,{className:"space-y-3",children:a?.slice(0,3).map(t=>e.jsx("div",{className:"p-3 bg-black/20 rounded-lg border border-white/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[d(t.severity),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"text-white font-medium",children:t.type}),e.jsx(c,{className:n(t.severity),children:t.severity.toUpperCase()}),e.jsx(c,{className:i(t.status),children:t.status.toUpperCase()})]}),e.jsx("div",{className:"text-gray-300 text-sm mb-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"secondary",className:"text-xs",children:t.source}),e.jsxs("span",{className:"text-gray-400 text-xs flex items-center gap-1",children:[e.jsx(R,{className:"w-3 h-3"}),new Date(t.timestamp).toLocaleTimeString()]})]})]})]})},t.id))})]}),e.jsx(_,{open:l,onOpenChange:o,children:e.jsxs(T,{className:"max-w-4xl max-h-[80vh] overflow-y-auto bg-gray-900 border-gray-700",children:[e.jsx(D,{children:e.jsxs(E,{className:"text-white flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5"}),"Threat Intelligence Details"]})}),e.jsx("div",{className:"space-y-4",children:a?.map(t=>e.jsx("div",{className:"p-4 bg-black/20 rounded-lg border border-white/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[d(t.severity),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-white font-medium text-lg",children:t.type}),e.jsx(c,{className:n(t.severity),children:t.severity.toUpperCase()}),e.jsx(c,{className:i(t.status),children:t.status.toUpperCase()})]}),e.jsx("div",{className:"text-gray-300 mb-3",children:t.description}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(c,{variant:"secondary",children:t.source}),e.jsx("span",{className:"text-gray-400 text-sm",children:new Date(t.timestamp).toLocaleString()})]}),t.affected_contracts&&t.affected_contracts.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"text-sm text-gray-400 mb-1 flex items-center gap-1",children:[e.jsx(L,{className:"w-4 h-4"}),"Affected Contracts:"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.affected_contracts.map((x,s)=>e.jsx(c,{variant:"outline",className:"text-xs",children:x},s))})]}),t.mitigation_actions&&t.mitigation_actions.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm text-gray-400 mb-1 flex items-center gap-1",children:[e.jsx(B,{className:"w-4 h-4"}),"Mitigation Actions:"]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-300",children:t.mitigation_actions.map((x,s)=>e.jsx("li",{children:x},s))})]})]})]})},t.id))})]})})]})}function Q(){const{wallet:a}=O();F();const[l,o]=w.useState("24h"),{data:n}=v({queryKey:["/api/security/status"],queryFn:async()=>{const r=await fetch(p("/api/security/status"));if(!r.ok)throw new Error("Failed to fetch security status");return r.json()},refetchInterval:1e4}),{data:i}=v({queryKey:["/api/security/alerts"],queryFn:async()=>{const r=await fetch(p("/api/security/alerts"));if(!r.ok)throw new Error("Failed to fetch security alerts");return r.json()},refetchInterval:15e3}),{data:d}=v({queryKey:["/api/security/metrics",l],queryFn:async()=>{const r=await fetch(p(`/api/security/metrics?timeframe=${l}`));if(!r.ok)throw new Error("Failed to fetch security metrics");return r.json()},refetchInterval:3e4}),{data:t}=v({queryKey:["/api/security/threats",l],queryFn:async()=>{const r=await fetch(p(`/api/security/threats?timeframe=${l}`));if(!r.ok)throw new Error("Failed to fetch threat intelligence");return r.json()},refetchInterval:15e3}),x=async r=>{try{if(!(await fetch(p(`/api/security/alerts/${r}/resolve`),{method:"POST",headers:{"Content-Type":"application/json"}})).ok)throw new Error("Failed to resolve alert");window.location.reload()}catch(j){throw console.error("Error resolving alert:",j),j}},s=d?.reduce((r,j)=>r+j.threats_blocked,0)||0,g=n?.systems?Object.values(n.systems).filter(Boolean).length:0;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center py-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Security Dashboard"}),e.jsx("p",{className:"text-gray-300",children:"Real-time security monitoring and threat detection"})]}),e.jsx(X,{securityStatus:n,threatsBlocked:s,systemsOnline:g}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Y,{alerts:i||[],onResolveAlert:x}),e.jsx(G,{threatData:t||[]})]}),e.jsx(H,{metrics:d||[],selectedTimeframe:l,onTimeframeChange:o})]})})}function Z(){return e.jsx(Q,{})}function ce(){return e.jsx(Z,{})}export{ce as default};
