const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web3-C8Lu7bQ_.js","assets/vendor-CEoFgRlV.js","assets/react-B-ht5LAu.js","assets/utils-B8vuxRvf.js"])))=>i.map(i=>d[i]);
import{O as _}from"./vendor-CEoFgRlV.js";import{r as b,j as e}from"./react-B-ht5LAu.js";import{i as L,u as O,b as A,C as N,c as v,B as X,d as C,e as T,A as M,m as D,g as K}from"./index-CunMlly4.js";import{I as g}from"./input-C7h7K1mu.js";import{L as u}from"./label-DP49jqZS.js";import{T as U}from"./textarea-Dwf9QYDG.js";import{P as G}from"./progress-BFBbhD-f.js";import{q as P,I as Z,a7 as E,Y as J,Z as Q,C as V,ah as Y}from"./utils-B8vuxRvf.js";import"./router-QSY63kmV.js";import"./ui-CRT7ecel.js";import"./web3-C8Lu7bQ_.js";function me(){const{wallet:l,connectWallet:q}=L(),{toast:o}=O(),[t,k]=b.useState({name:"",symbol:"",totalSupply:"",recipientAddress:"",description:"",website:"",twitter:"",telegram:"",logo:""});b.useEffect(()=>{l.address&&l.address!==t.recipientAddress&&k(s=>({...s,recipientAddress:l.address}))},[l.address]);const[y,w]=b.useState(!1),[S,j]=b.useState(0),[z,x]=b.useState(null),[F,h]=b.useState([{id:1,title:"Deploy Token Contract",description:"Deploy XIP-20 standard token contract to Xphere network",status:"pending"},{id:2,title:"Mint Initial Supply",description:"Mint specified total supply and transfer to recipient address",status:"pending"},{id:3,title:"Register Token Info",description:"Register token metadata with DEX",status:"pending"},{id:4,title:"Create Liquidity Pool",description:"Create initial liquidity pool with XP (optional)",status:"pending"},{id:5,title:"Enable Trading",description:"Activate token trading on DEX",status:"pending"}]),{data:c}=A({queryKey:["/api/minting/fees"],refetchInterval:3e4}),{data:I}=A({queryKey:["/api/blockchain/balance",l.address,"XP"],enabled:!!l.address,refetchInterval:5e3}),m=(s,a)=>{k(f=>({...f,[s]:a}))},R=()=>{const s=[];return t.name.trim()||s.push("Token name is required"),(!t.symbol.trim()||t.symbol.length<2||t.symbol.length>10)&&s.push("Token symbol must be 2-10 characters"),(isNaN(Number(t.totalSupply))||Number(t.totalSupply)<=0)&&s.push("Please enter a valid total supply"),/^0x[a-fA-F0-9]{40}$/.test(t.recipientAddress)||s.push("Please enter a valid wallet address"),s},$=async()=>{if(!l.isConnected){o({title:"Wallet Connection Required",description:"Please connect your wallet to mint tokens.",variant:"destructive"});return}const s=R();if(s.length>0){o({title:"Input Error",description:s.join(", "),variant:"destructive"});return}if(I&&c&&parseFloat(I.balance)<c.feeInXP){o({title:"Insufficient Balance",description:`Not enough XP for minting fees. Required: ${c.feeInXP} XP`,variant:"destructive"});return}w(!0),j(0),x(1);try{h(r=>r.map(i=>i.id===1?{...i,status:"processing"}:i)),o({title:"Starting Token Deployment",description:"Deploying your token contract to Xphere blockchain..."});let a=null;try{const{web3Service:r}=await _(async()=>{const{web3Service:i}=await import("./web3-C8Lu7bQ_.js").then(p=>p.e);return{web3Service:i}},__vite__mapDeps([0,1,2,3]));if(a=await r.deployToken(t.name,t.symbol,t.totalSupply,t.recipientAddress,t.description),a.success)console.log("Token deployed successfully:",a),h(i=>i.map(p=>p.id===1?{...p,status:"completed",txHash:a.transactionHash}:p)),j(20),x(2),o({title:"Token Deployed Successfully",description:`Contract address: ${a.contractAddress?.slice(0,20)}...`});else throw new Error(a.error||"Deployment failed")}catch(r){console.warn("Web3 deployment failed, using API fallback:",r);const i=await fetch(K("/api/minting/deploy"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,userAddress:l.address})});if(!i.ok)throw new Error("Token deployment failed");a=await i.json()}const f=[{id:2,name:"Initial Supply Minting",delay:2e3,progress:40},{id:3,name:"Token Registration",delay:1500,progress:60},{id:4,name:"Liquidity Pool Setup",delay:2e3,progress:80},{id:5,name:"Trading Activation",delay:1e3,progress:100}];for(const r of f){h(d=>d.map(n=>n.id===r.id?{...n,status:"processing"}:n)),x(r.id);const p=r.delay/10;for(let d=0;d<10;d++){await new Promise(W=>setTimeout(W,p));const n=(d+1)/10,H=r.id===2?20:(r.id-2)*20+20,B=20*n;j(Math.min(H+B,r.progress))}h(d=>d.map(n=>n.id===r.id?{...n,status:"completed",txHash:r.txHash||""}:n)),o({title:`Step ${r.id} Complete`,description:`${r.name} completed successfully`,variant:"default"}),x(r.id),j(r.id/5*100),h(d=>d.map(n=>n.id===r.id?{...n,status:"completed",txHash:a.txHash||a.transactionHash}:n)),o({title:`Step ${r.id} Completed`,description:`${r.name} completed successfully`})}w(!1),x(null),o({title:"Token Minting Completed",description:`${t.name} (${t.symbol}) has been successfully created and deployed!`}),a?.contractAddress&&setTimeout(()=>{o({title:"Contract Details",description:`Contract Address: ${a.contractAddress}`})},2e3),k({name:"",symbol:"",totalSupply:"",recipientAddress:l.address||"",description:"",website:"",twitter:"",telegram:"",logo:""})}catch(a){console.error("Token minting error:",a),w(!1),x(null),h(f=>f.map(r=>r.status==="processing"?{...r,status:"failed"}:r)),o({title:"Token Minting Failed",description:a.message||"An error occurred during token minting. Please try again.",variant:"destructive"})}};return l.isConnected?e.jsx("div",{className:"min-h-screen bg-background p-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-primary/20 to-primary/10 rounded-full flex items-center justify-center",children:e.jsx(P,{className:"w-6 h-6 text-primary"})}),e.jsx("h1",{className:"text-4xl font-bold text-foreground",children:"XIP-20 Mint"})]}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Create XIP-20 standard tokens easily on Xphere Network"})]}),c&&e.jsxs(N,{className:"bg-card backdrop-blur-lg border-border",children:[e.jsx(C,{children:e.jsxs(T,{className:"text-foreground flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5"}),"Minting Fees"]})}),e.jsx(v,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Base Gas"}),e.jsxs("p",{className:"text-lg font-semibold text-foreground",children:[c.baseGas," XP"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Minting Fee"}),e.jsxs("p",{className:"text-lg font-semibold text-foreground",children:["$",c.mintingFeeUSD]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pay with XP"}),e.jsxs("p",{className:"text-lg font-semibold text-foreground",children:[c.feeInXP," XP"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pay with XPS (50% off)"}),e.jsxs("p",{className:"text-lg font-semibold text-primary",children:[c.feeInXPS," XPS"]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(N,{className:"bg-card backdrop-blur-lg border-border",children:[e.jsx(C,{children:e.jsx(T,{className:"text-foreground",children:"Token Information"})}),e.jsxs(v,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-foreground",children:"Token Name *"}),e.jsx(g,{value:t.name,onChange:s=>m("name",s.target.value),placeholder:"e.g., My Token",className:"bg-background border-border text-foreground"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-foreground",children:"Token Symbol *"}),e.jsx(g,{value:t.symbol,onChange:s=>m("symbol",s.target.value.toUpperCase()),placeholder:"e.g., MTK",className:"bg-background border-border text-foreground"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-foreground",children:"Total Supply *"}),e.jsx(g,{type:"number",value:t.totalSupply,onChange:s=>m("totalSupply",s.target.value),placeholder:"e.g., 1000000",className:"bg-background border-border text-foreground"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-foreground",children:"Recipient Address *"}),e.jsx(g,{value:t.recipientAddress,onChange:s=>m("recipientAddress",s.target.value),placeholder:"0x...",className:"bg-background border-border text-foreground"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-foreground",children:"Description"}),e.jsx(U,{value:t.description,onChange:s=>m("description",s.target.value),placeholder:"Describe your token...",className:"bg-background border-border text-foreground"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-foreground",children:"Website"}),e.jsx(g,{value:t.website,onChange:s=>m("website",s.target.value),placeholder:"https://...",className:"bg-background border-border text-foreground"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-foreground",children:"Twitter"}),e.jsx(g,{value:t.twitter,onChange:s=>m("twitter",s.target.value),placeholder:"@username",className:"bg-background border-border text-foreground"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-foreground",children:"Telegram"}),e.jsx(g,{value:t.telegram,onChange:s=>m("telegram",s.target.value),placeholder:"@channel",className:"bg-background border-border text-foreground"})]})]}),e.jsxs(M,{className:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx(D,{className:"text-yellow-700 dark:text-yellow-400",children:"* Required fields. Token details cannot be changed after deployment."})]}),e.jsx(X,{onClick:$,disabled:y||!t.name||!t.symbol||!t.totalSupply,className:"w-full bg-primary hover:bg-primary/90",children:y?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"w-4 h-4 mr-2 animate-spin"}),"Minting Token..."]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Mint Token"]})})]})]}),e.jsxs(N,{className:"bg-card backdrop-blur-lg border-border",children:[e.jsx(C,{children:e.jsxs(T,{className:"text-foreground flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5"}),"Minting Progress"]})}),e.jsxs(v,{className:"space-y-4",children:[y&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-foreground",children:"Progress"}),e.jsxs("span",{className:"text-foreground",children:[S.toFixed(0),"%"]})]}),e.jsx(G,{value:S,className:"h-2"})]}),e.jsx("div",{className:"space-y-3",children:F.map(s=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"mt-1",children:[s.status==="pending"&&e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-muted-foreground"}),s.status==="processing"&&e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-blue-600 border-t-transparent animate-spin"}),s.status==="completed"&&e.jsx(V,{className:"w-4 h-4 text-green-600"}),s.status==="failed"&&e.jsx(Y,{className:"w-4 h-4 text-red-600"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-foreground font-medium",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description}),s.txHash&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["TX: ",s.txHash.substring(0,20),"..."]})]})]},s.id))}),!y&&e.jsxs(M,{className:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx(D,{className:"text-blue-700 dark:text-blue-400",children:'Fill in token details and click "Mint Token" to begin deployment process.'})]})]})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-background p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(N,{className:"bg-card backdrop-blur-lg border-border",children:e.jsxs(v,{className:"p-8 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-primary/20 to-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(P,{className:"w-8 h-8 text-primary"})}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Connect Wallet Required"}),e.jsx("p",{className:"text-muted-foreground",children:"Please connect your wallet to mint tokens"})]}),e.jsx(X,{onClick:q,className:"bg-primary hover:bg-primary/90",children:"Connect Wallet"})]})})})})}export{me as default};
