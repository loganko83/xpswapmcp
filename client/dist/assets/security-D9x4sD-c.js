import{j as e,H as k,v as q,h as L,ab as E,r as C,T as j,a6 as F,C as A,a7 as D,y as P,aw as T,a2 as K}from"./react-vendor-whffYpp3.js";import{C as g,c as p,f as n,u as U,d as _,e as S,B as v,D as M,j as R,k as B,l as I,i as W,b as w,g as b}from"./index-TmnicXAN.js";import{P as $}from"./progress-BEk68puA.js";import{U as z,V as H,W as V,X as G,Y as X,Z as Y,$ as f}from"./vendor-C9R_Cz-L.js";import"./router-Chclg4Zx.js";import"./ui-DDPZ4K8P.js";import"./utils-BkLtITBR.js";import"./web3-DuRBVa1D.js";function Q({securityStatus:i,threatsBlocked:l,systemsOnline:x}){const o=d=>{switch(d){case"secure":return"text-green-500";case"warning":return"text-yellow-500";case"critical":return"text-red-500";default:return"text-gray-500"}},c=d=>{switch(d){case"secure":return"bg-green-100 text-green-800 border-green-200";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"critical":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(g,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-3 rounded-full ${i?.overall==="secure"?"bg-green-500/20":i?.overall==="warning"?"bg-yellow-500/20":"bg-red-500/20"}`,children:e.jsx(k,{className:`w-6 h-6 ${o(i?.overall||"secure")}`})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:"Security Status"}),e.jsx(n,{className:c(i?.overall||"secure"),children:i?.overall?.toUpperCase()||"SECURE"})]})]})})}),e.jsx(g,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:e.jsxs(p,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-blue-500/20",children:e.jsx(q,{className:"w-6 h-6 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:"Security Score"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:[i?.score||0,"/100"]})]})]}),e.jsx($,{value:i?.score||0,className:"mt-3 h-2"})]})}),e.jsx(g,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-green-500/20",children:e.jsx(L,{className:"w-6 h-6 text-green-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:"Threats Blocked"}),e.jsx("div",{className:"text-2xl font-bold text-green-400",children:l.toLocaleString()})]})]})})}),e.jsx(g,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-purple-500/20",children:e.jsx(E,{className:"w-6 h-6 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:"Systems Online"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:[x,"/8"]})]})]})})})]})}function Z({alerts:i,onResolveAlert:l}){const[x,o]=C.useState(!1),{toast:c}=U(),d=s=>{switch(s){case"low":return e.jsx(A,{className:"w-4 h-4 text-blue-500"});case"medium":return e.jsx(j,{className:"w-4 h-4 text-yellow-500"});case"high":return e.jsx(D,{className:"w-4 h-4 text-orange-500"});case"critical":return e.jsx(D,{className:"w-4 h-4 text-red-500"});default:return e.jsx(A,{className:"w-4 h-4 text-gray-500"})}},t=s=>{switch(s){case"low":return"bg-blue-100 text-blue-800 border-blue-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"critical":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},u=async s=>{try{await l(s),c({title:"Alert Resolved",description:"Security alert has been successfully resolved."})}catch{c({title:"Error",description:"Failed to resolve alert. Please try again.",variant:"destructive"})}};return e.jsxs(e.Fragment,{children:[e.jsxs(g,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:[e.jsxs(_,{className:"flex flex-row items-center justify-between",children:[e.jsxs(S,{className:"text-white flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5"}),"Security Alerts"]}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>o(!0),className:"bg-transparent border-white/20 text-white hover:bg-white/10",children:"View All"})]}),e.jsx(p,{className:"space-y-3",children:Array.isArray(i)?i.slice(0,5).map(s=>e.jsx("div",{className:"p-3 bg-black/20 rounded-lg border border-white/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[d(s.severity),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-white font-medium",children:s.title}),e.jsx("div",{className:"text-gray-300 text-sm",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(n,{variant:"secondary",className:"text-xs",children:s.source}),e.jsx(n,{className:`text-xs ${t(s.severity)}`,children:s.severity.toUpperCase()}),e.jsxs("span",{className:"text-gray-400 text-xs flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"}),new Date(s.timestamp).toLocaleTimeString()]})]})]}),s.action_required&&!s.resolved&&e.jsx(v,{size:"sm",onClick:()=>u(s.id),className:"bg-blue-500 hover:bg-blue-600",children:"Resolve"})]})},s.id)):null})]}),e.jsx(M,{open:x,onOpenChange:o,children:e.jsxs(R,{className:"max-w-4xl max-h-[80vh] overflow-y-auto bg-gray-900 border-gray-700",children:[e.jsx(B,{children:e.jsxs(I,{className:"text-white flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5"}),"All Security Alerts"]})}),e.jsx("div",{className:"space-y-4",children:i?.map(s=>e.jsx("div",{className:"p-4 bg-black/20 rounded-lg border border-white/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[d(s.severity),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-white font-medium",children:s.title}),e.jsx(n,{className:t(s.severity),children:s.severity.toUpperCase()}),s.resolved&&e.jsx(n,{className:"bg-green-100 text-green-800",children:"RESOLVED"})]}),e.jsx("div",{className:"text-gray-300 text-sm mb-3",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(n,{variant:"secondary",className:"text-xs",children:s.source}),e.jsx("span",{className:"text-gray-400 text-xs",children:new Date(s.timestamp).toLocaleString()})]}),s.affected_components&&s.affected_components.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Affected Components:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.affected_components.map((y,a)=>e.jsx(n,{variant:"outline",className:"text-xs",children:y},a))})]}),s.resolution_steps&&s.resolution_steps.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Resolution Steps:"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-300",children:s.resolution_steps.map((y,a)=>e.jsx("li",{children:y},a))})]})]}),s.action_required&&!s.resolved&&e.jsx(v,{size:"sm",onClick:()=>u(s.id),className:"bg-blue-500 hover:bg-blue-600",children:"Resolve"})]})},s.id))})]})})]})}function J({metrics:i,selectedTimeframe:l,onTimeframeChange:x}){const o=["1h","24h","7d","30d"];return e.jsxs(g,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:[e.jsxs(_,{className:"flex flex-row items-center justify-between",children:[e.jsxs(S,{className:"text-white flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),"Security Metrics"]}),e.jsx("div",{className:"flex gap-2",children:o.map(c=>e.jsx(v,{variant:l===c?"default":"outline",size:"sm",onClick:()=>x(c),className:l===c?"bg-purple-500 hover:bg-purple-600":"bg-transparent border-white/20 text-white hover:bg-white/10",children:c},c))})]}),e.jsx(p,{children:e.jsx("div",{className:"h-64",children:e.jsx(z,{width:"100%",height:"100%",children:e.jsxs(H,{data:i,children:[e.jsx(V,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(G,{dataKey:"timestamp",stroke:"#9CA3AF"}),e.jsx(X,{stroke:"#9CA3AF"}),e.jsx(Y,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"8px",color:"#F9FAFB"}}),e.jsx(f,{type:"monotone",dataKey:"threats_blocked",stroke:"#10B981",strokeWidth:2,name:"Threats Blocked"}),e.jsx(f,{type:"monotone",dataKey:"security_score",stroke:"#3B82F6",strokeWidth:2,name:"Security Score"}),e.jsx(f,{type:"monotone",dataKey:"suspicious_activity",stroke:"#F59E0B",strokeWidth:2,name:"Suspicious Activity"}),e.jsx(f,{type:"monotone",dataKey:"failed_attempts",stroke:"#EF4444",strokeWidth:2,name:"Failed Attempts"}),e.jsx(f,{type:"monotone",dataKey:"successful_defenses",stroke:"#8B5CF6",strokeWidth:2,name:"Successful Defenses"})]})})})})]})}function ee({threatData:i}){const[l,x]=C.useState(!1),o=t=>{switch(t){case"low":return"bg-blue-100 text-blue-800 border-blue-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"critical":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},c=t=>{switch(t){case"active":return"bg-red-100 text-red-800 border-red-200";case"mitigated":return"bg-green-100 text-green-800 border-green-200";case"investigating":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},d=t=>{switch(t){case"low":return e.jsx(k,{className:"w-4 h-4 text-blue-500"});case"medium":return e.jsx(j,{className:"w-4 h-4 text-yellow-500"});case"high":return e.jsx(j,{className:"w-4 h-4 text-orange-500"});case"critical":return e.jsx(j,{className:"w-4 h-4 text-red-500"});default:return e.jsx(k,{className:"w-4 h-4 text-gray-500"})}};return e.jsxs(e.Fragment,{children:[e.jsxs(g,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:[e.jsxs(_,{className:"flex flex-row items-center justify-between",children:[e.jsxs(S,{className:"text-white flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5"}),"Threat Intelligence"]}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>x(!0),className:"bg-transparent border-white/20 text-white hover:bg-white/10",children:"View Details"})]}),e.jsx(p,{className:"space-y-3",children:i?.slice(0,3).map(t=>e.jsx("div",{className:"p-3 bg-black/20 rounded-lg border border-white/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[d(t.severity),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"text-white font-medium",children:t.type}),e.jsx(n,{className:o(t.severity),children:t.severity.toUpperCase()}),e.jsx(n,{className:c(t.status),children:t.status.toUpperCase()})]}),e.jsx("div",{className:"text-gray-300 text-sm mb-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{variant:"secondary",className:"text-xs",children:t.source}),e.jsxs("span",{className:"text-gray-400 text-xs flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"}),new Date(t.timestamp).toLocaleTimeString()]})]})]})]})},t.id))})]}),e.jsx(M,{open:l,onOpenChange:x,children:e.jsxs(R,{className:"max-w-4xl max-h-[80vh] overflow-y-auto bg-gray-900 border-gray-700",children:[e.jsx(B,{children:e.jsxs(I,{className:"text-white flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5"}),"Threat Intelligence Details"]})}),e.jsx("div",{className:"space-y-4",children:i?.map(t=>e.jsx("div",{className:"p-4 bg-black/20 rounded-lg border border-white/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[d(t.severity),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-white font-medium text-lg",children:t.type}),e.jsx(n,{className:o(t.severity),children:t.severity.toUpperCase()}),e.jsx(n,{className:c(t.status),children:t.status.toUpperCase()})]}),e.jsx("div",{className:"text-gray-300 mb-3",children:t.description}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(n,{variant:"secondary",children:t.source}),e.jsx("span",{className:"text-gray-400 text-sm",children:new Date(t.timestamp).toLocaleString()})]}),t.affected_contracts&&t.affected_contracts.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"text-sm text-gray-400 mb-1 flex items-center gap-1",children:[e.jsx(K,{className:"w-4 h-4"}),"Affected Contracts:"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.affected_contracts.map((u,s)=>e.jsx(n,{variant:"outline",className:"text-xs",children:u},s))})]}),t.mitigation_actions&&t.mitigation_actions.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm text-gray-400 mb-1 flex items-center gap-1",children:[e.jsx(E,{className:"w-4 h-4"}),"Mitigation Actions:"]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-300",children:t.mitigation_actions.map((u,s)=>e.jsx("li",{children:u},s))})]})]})]})},t.id))})]})})]})}function se(){const{wallet:i}=W();U();const[l,x]=C.useState("24h"),{data:o}=w({queryKey:["/api/security/status"],queryFn:async()=>{const a=await fetch(b("/api/security/status"));if(!a.ok)throw new Error("Failed to fetch security status");const r=await a.json();if(r.success&&r.data){const m=r.data;return{overall:m.status==="SECURE"?"secure":"warning",score:95,lastUpdated:Date.now(),systems:{reentrancy:m.checks?.cryptoSecurityEnabled||!1,mev_protection:m.checks?.rateLimitingActive||!1,circuit_breaker:m.checks?.errorLeakPrevention||!1,slippage_protection:m.checks?.inputValidationActive||!1,flash_loan_protection:m.checks?.xssProtectionEnabled||!1,governance_security:m.checks?.securityHeadersEnabled||!1,oracle_security:m.checks?.sqlInjectionProtectionEnabled||!1,pause_mechanism:m.checks?.corsEnabled||!1}}}return{overall:"secure",score:95,lastUpdated:Date.now(),systems:{reentrancy:!0,mev_protection:!0,circuit_breaker:!0,slippage_protection:!0,flash_loan_protection:!0,governance_security:!0,oracle_security:!0,pause_mechanism:!0}}},refetchInterval:1e4}),{data:c}=w({queryKey:["/api/security/alerts"],queryFn:async()=>{const a=await fetch(b("/api/security/alerts"));if(!a.ok)throw new Error("Failed to fetch security alerts");const r=await a.json();return r.success&&r.data&&r.data.recent?r.data.recent:[{id:"alert-1",type:"security",severity:"medium",title:"Unusual Transaction Pattern Detected",description:"Multiple transactions with similar amounts detected from same wallet",timestamp:Date.now()-3e5,source:"Transaction Monitor",action_required:!0,resolved:!1,affected_components:["Swap Interface"],resolution_steps:["Review transaction details","Contact wallet owner if necessary"]},{id:"alert-2",type:"warning",severity:"low",title:"High Gas Price Alert",description:"Current gas prices are above average threshold",timestamp:Date.now()-6e5,source:"Gas Monitor",action_required:!1,resolved:!1,affected_components:["Transaction Processing"]}]},refetchInterval:15e3}),{data:d}=w({queryKey:["/api/security/metrics",l],queryFn:async()=>{const a=await fetch(b(`/api/security/metrics?timeframe=${l}`));if(!a.ok)throw new Error("Failed to fetch security metrics");const r=await a.json();if(r.success&&r.data){const m=new Date,h=[];for(let N=23;N>=0;N--){const O=new Date(m.getTime()-N*60*60*1e3);h.push({timestamp:O.toISOString(),threats_blocked:Math.floor(Math.random()*10),security_score:85+Math.floor(Math.random()*15),suspicious_activity:Math.floor(Math.random()*5),failed_attempts:Math.floor(Math.random()*3),successful_defenses:Math.floor(Math.random()*8)})}return h}return[]},refetchInterval:3e4}),{data:t}=w({queryKey:["/api/security/threats",l],queryFn:async()=>{const a=await fetch(b(`/api/security/threats?timeframe=${l}`));if(!a.ok)throw new Error("Failed to fetch threat intelligence");const r=await a.json();return r.success&&r.data?{threats:r.data.threats.map(h=>({id:h.id,type:h.type,severity:h.severity.toLowerCase(),description:h.description,source:h.source||"Unknown",timestamp:new Date(h.timestamp).getTime(),status:"active",affected_contracts:[],mitigation_actions:["Monitor ongoing","Apply security filters"]})),lastUpdate:r.data.lastUpdate}:{threats:[],lastUpdate:new Date().toISOString()}},refetchInterval:15e3}),u=async a=>{try{if(!(await fetch(b(`/api/security/alerts/${a}/resolve`),{method:"POST",headers:{"Content-Type":"application/json"}})).ok)throw new Error("Failed to resolve alert");window.location.reload()}catch(r){throw console.error("Error resolving alert:",r),r}},s=Array.isArray(d)?d.reduce((a,r)=>a+(r.threats_blocked||0),0):0,y=o?.systems?Object.values(o.systems).filter(Boolean).length:0;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center py-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Security Dashboard"}),e.jsx("p",{className:"text-gray-300",children:"Real-time security monitoring and threat detection"})]}),e.jsx(Q,{securityStatus:o,threatsBlocked:s,systemsOnline:y}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Z,{alerts:c||[],onResolveAlert:u}),e.jsx(ee,{threatData:t?.threats||[]})]}),e.jsx(J,{metrics:d||[],selectedTimeframe:l,onTimeframeChange:x})]})})}function de(){return e.jsx(se,{})}export{de as default};
