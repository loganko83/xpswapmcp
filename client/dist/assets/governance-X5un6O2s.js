import{r as j,j as e,a$ as fe,b0 as be,b1 as Te,a0 as Re,b2 as W,aj as $e,ak as Ve,b3 as De,x as Fe,ad as P,aw as re,F as b,am as H,b4 as Ie,aI as Z,aM as ee,b5 as ye,b6 as Oe,ap as Q,aq as le,a9 as K,a8 as se,at as qe,s as ue,v as ze,t as D,B as X,ai as O,aE as B,b7 as we,aX as q,ah as E,aP as Me,b8 as Le,b9 as Ee,aL as Ye,aD as Ke}from"./react-CnjVYTDc.js";import{n as G,B as u,u as z,D as ie,h as ne,i as ce,j as de,C as i,a as n,d as h,f as M,b as v,c as f,o as oe,A as Xe,k as Be,g as ke}from"./index-DxHLzNoH.js";import{P as T}from"./progress-BqIT0-Qh.js";import{T as xe}from"./textarea-1azl9xt-.js";import{I as J}from"./input-BJWVzqi3.js";import{L as U}from"./label-Cv6fFAQ8.js";import{S as Ge,a as Ue,b as Qe,c as _e,d as Y}from"./select-CKrfnZoO.js";import{T as me,a as he,b as R,c as $}from"./tabs-1rBqboxz.js";import{u as Je}from"./useTokenPrices-DtKVxnmy.js";import{X as je,Y as We,Z as pe,$ as ge,a0 as Ne,a1 as ve,a2 as He,a3 as Ze,a4 as es}from"./vendor-B0r8BCsL.js";import"./ui-BQCqNqg0.js";import"./router-B_5Dh3-u.js";import"./utils-BkLtITBR.js";import"./web3-30Ii_1H8.js";const Ce=j.forwardRef(({className:s,...c},d)=>e.jsx(fe,{className:G("grid gap-2",s),...c,ref:d}));Ce.displayName=fe.displayName;const ae=j.forwardRef(({className:s,...c},d)=>e.jsx(be,{ref:d,className:G("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...c,children:e.jsx(Te,{className:"flex items-center justify-center",children:e.jsx(Re,{className:"h-2.5 w-2.5 fill-current text-current"})})}));ae.displayName=be.displayName;function ss({insight:s,isOpen:c,onClose:d}){const{toast:p}=z(),[x,N]=j.useState(""),[S,y]=j.useState(!1),{data:k}=Je([s.data.tokenA||"XP"]),g=()=>{const t=window.location.origin;let o="";switch(s.type){case"trade":o=`🚀 Just executed a ${s.data.tokenA}/${s.data.tokenB} swap on @XpSwap_DEX!

`,o+=`💰 Amount: ${s.data.amount} ${s.data.tokenA}
`,o+=`📈 Price: $${s.data.price}
`,s.data.change&&(o+=`📊 24h Change: ${s.data.change}%
`);break;case"pool":o=`💎 Added liquidity to ${s.data.tokenA}/${s.data.tokenB} pool on @XpSwap_DEX!

`,o+=`🏦 TVL: $${s.data.tvl}
`,o+=`🎯 APR: ${s.data.apy}%
`,o+=`💰 Contributing: ${s.data.amount} tokens
`;break;case"farm":o=`🌾 Staking in ${s.data.tokenA} farm on @XpSwap_DEX!

`,o+=`🎯 APR: ${s.data.apy}%
`,o+=`💰 Staked: ${s.data.amount} ${s.data.tokenA}
`,s.performance&&(o+=`📈 ROI: ${s.performance.roi}% (${s.performance.timeframe})
`);break;case"analysis":o=`📊 Market Analysis: ${s.title}

`,o+=`${s.description}
`,s.data.change&&(o+=`📈 Performance: ${s.data.change}%
`);break}return o+=`
#XpSwap #DeFi #Xphere #Trading
`,o+=`${t}`,x.trim()&&(o=`${x}

${o}`),o},C=()=>{let t="";switch(s.type){case"trade":t=`🔥 <b>Successful Trade on XpSwap!</b>

`,t+=`💱 Pair: <code>${s.data.tokenA}/${s.data.tokenB}</code>
`,t+=`💰 Amount: <code>${s.data.amount} ${s.data.tokenA}</code>
`,t+=`💲 Price: <code>$${s.data.price}</code>
`;break;case"pool":t=`💎 <b>Liquidity Provision Update</b>

`,t+=`🏊 Pool: <code>${s.data.tokenA}/${s.data.tokenB}</code>
`,t+=`📊 TVL: <code>$${s.data.tvl}</code>
`,t+=`🎯 APR: <code>${s.data.apy}%</code>
`;break;case"farm":t=`🌾 <b>Yield Farming Success</b>

`,t+=`🚜 Farm: <code>${s.data.tokenA}</code>
`,t+=`💰 Staked: <code>${s.data.amount} ${s.data.tokenA}</code>
`,t+=`🎯 APR: <code>${s.data.apy}%</code>
`;break}return t+=`
🌐 Trade on XpSwap: ${window.location.origin}`,t},m=()=>{const t=g(),o=`https://twitter.com/intent/tweet?text=${encodeURIComponent(t)}`;window.open(o,"_blank","width=550,height=420"),p({title:"Shared to Twitter",description:"Your trading insight has been shared!"})},V=()=>{const t=C(),o=`https://t.me/share/url?url=${encodeURIComponent(window.location.origin)}&text=${encodeURIComponent(t)}`;window.open(o,"_blank"),p({title:"Shared to Telegram",description:"Your trading insight has been shared!"})},w=async()=>{try{const t=g();await navigator.clipboard.writeText(t),p({title:"Copied to Clipboard",description:"Trading insight copied successfully!"})}catch{p({title:"Copy Failed",description:"Failed to copy to clipboard",variant:"destructive"})}},a=()=>{const o=g().replace(/\*\*(.*?)\*\*/g,"**$1**").replace(/\n/g,`
`);navigator.clipboard.writeText(o).then(()=>{p({title:"Copied for Discord",description:"Content copied! Paste it in your Discord channel."})})},A=()=>{switch(s.type){case"trade":return e.jsx(P,{className:"w-5 h-5 text-green-500"});case"pool":return e.jsx(re,{className:"w-5 h-5 text-blue-500"});case"farm":return e.jsx(P,{className:"w-5 h-5 text-purple-500"});case"analysis":return e.jsx(P,{className:"w-5 h-5 text-orange-500"});default:return e.jsx(W,{className:"w-5 h-5"})}},l=()=>{switch(s.type){case"trade":return"bg-green-100 dark:bg-green-900 border-green-200 dark:border-green-800";case"pool":return"bg-blue-100 dark:bg-blue-900 border-blue-200 dark:border-blue-800";case"farm":return"bg-purple-100 dark:bg-purple-900 border-purple-200 dark:border-purple-800";case"analysis":return"bg-orange-100 dark:bg-orange-900 border-orange-200 dark:border-orange-800";default:return"bg-gray-100 dark:bg-gray-900 border-gray-200 dark:border-gray-800"}};return e.jsx(ie,{open:c,onOpenChange:d,children:e.jsxs(ne,{className:"max-w-lg",children:[e.jsx(ce,{children:e.jsxs(de,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),"Share Trading Insight"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(i,{className:`${l()}`,children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[A(),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-sm",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[s.data.tokenA&&e.jsx(h,{variant:"secondary",className:"text-xs",children:s.data.tokenA}),s.data.amount&&e.jsx(h,{variant:"outline",className:"text-xs",children:s.data.amount}),s.data.apy&&e.jsxs(h,{variant:"outline",className:"text-xs text-green-600",children:[s.data.apy,"% APR"]}),s.performance&&e.jsxs(h,{variant:"outline",className:"text-xs text-blue-600",children:[s.performance.roi,"% ROI"]})]})]})]})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Add Custom Message (Optional)"}),e.jsx(xe,{placeholder:"Add your own commentary or insights...",value:x,onChange:t=>N(t.target.value),className:"min-h-[80px]",maxLength:280}),e.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[x.length,"/280 characters"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Share on:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(u,{variant:"outline",className:"flex items-center gap-2 bg-blue-50 hover:bg-blue-100 dark:bg-blue-950 dark:hover:bg-blue-900 border-blue-200 dark:border-blue-800",onClick:m,children:[e.jsx($e,{className:"w-4 h-4 text-blue-500"}),"Twitter"]}),e.jsxs(u,{variant:"outline",className:"flex items-center gap-2 bg-blue-50 hover:bg-blue-100 dark:bg-blue-950 dark:hover:bg-blue-900 border-blue-200 dark:border-blue-800",onClick:V,children:[e.jsx(Ve,{className:"w-4 h-4 text-blue-500"}),"Telegram"]}),e.jsxs(u,{variant:"outline",className:"flex items-center gap-2 bg-indigo-50 hover:bg-indigo-100 dark:bg-indigo-950 dark:hover:bg-indigo-900 border-indigo-200 dark:border-indigo-800",onClick:a,children:[e.jsx(De,{className:"w-4 h-4 text-indigo-500"}),"Discord"]}),e.jsxs(u,{variant:"outline",className:"flex items-center gap-2",onClick:w,children:[e.jsx(Fe,{className:"w-4 h-4"}),"Copy Link"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Preview:"}),e.jsx("div",{className:"bg-muted/50 rounded-lg p-3 text-xs text-muted-foreground border",children:e.jsxs("pre",{className:"whitespace-pre-wrap font-mono",children:[g().substring(0,200),g().length>200&&"..."]})})]})]})]})})}function as({insight:s,size:c="sm",variant:d="ghost"}){const[p,x]=j.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(u,{variant:d,size:c,onClick:()=>x(!0),className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),"Share"]}),e.jsx(ss,{insight:s,isOpen:p,onClose:()=>x(!1)})]})}function ts(){const{wallet:s}=M(),{data:c}=b({queryKey:["/api/governance/analytics"],enabled:!!s.address,refetchInterval:1e4}),{data:d}=b({queryKey:["/api/governance/participation"],enabled:!!s.address}),{data:p}=b({queryKey:["/api/governance/voting-trends"],enabled:!!s.address});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(i,{children:[e.jsx(v,{className:"pb-3",children:e.jsxs(f,{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{children:"Voter Participation"})]})}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Current Period"}),e.jsx("span",{className:"font-medium",children:d?.currentPeriod||"78%"})]}),e.jsx(T,{value:d?.currentPeriod||78,className:"h-2"}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[e.jsx(P,{className:"w-3 h-3 text-green-500"}),e.jsx("span",{children:"+5.2% from last period"})]})]})})]}),e.jsxs(i,{children:[e.jsx(v,{className:"pb-3",children:e.jsxs(f,{className:"flex items-center space-x-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{children:"Proposal Success Rate"})]})}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Last 30 Days"}),e.jsx("span",{className:"font-medium",children:c?.successRate||"85%"})]}),e.jsx(T,{value:c?.successRate||85,className:"h-2"}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[e.jsx(P,{className:"w-3 h-3 text-green-500"}),e.jsx("span",{children:"Above average"})]})]})})]}),e.jsxs(i,{children:[e.jsx(v,{className:"pb-3",children:e.jsxs(f,{className:"flex items-center space-x-2",children:[e.jsx(Z,{className:"w-5 h-5 text-purple-500"}),e.jsx("span",{children:"Voting Activity"})]})}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-2xl font-bold",children:c?.dailyVotes||"1,247"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Votes today"}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[e.jsx(P,{className:"w-3 h-3 text-green-500"}),e.jsx("span",{children:"+12% from yesterday"})]})]})})]})]}),e.jsxs(i,{children:[e.jsx(v,{children:e.jsx(f,{children:"Voting Trends by Category"})}),e.jsx(n,{children:e.jsx("div",{className:"space-y-4",children:p?.categories?.map((x,N)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{variant:"outline",children:x.type}),e.jsx("span",{className:"text-sm font-medium",children:x.name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:x.votes}),x.trend==="up"?e.jsx(P,{className:"w-4 h-4 text-green-500"}):e.jsx(ee,{className:"w-4 h-4 text-red-500"})]})]}),e.jsx(T,{value:x.percentage,className:"h-2"})]},N))||e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{variant:"outline",children:"parameter"}),e.jsx("span",{className:"text-sm font-medium",children:"Parameter Changes"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"2,847"}),e.jsx(P,{className:"w-4 h-4 text-green-500"})]})]}),e.jsx(T,{value:45,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{variant:"outline",children:"treasury"}),e.jsx("span",{className:"text-sm font-medium",children:"Treasury Proposals"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"1,923"}),e.jsx(P,{className:"w-4 h-4 text-green-500"})]})]}),e.jsx(T,{value:30,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{variant:"outline",children:"upgrade"}),e.jsx("span",{className:"text-sm font-medium",children:"Protocol Upgrades"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"856"}),e.jsx(ee,{className:"w-4 h-4 text-red-500"})]})]}),e.jsx(T,{value:15,className:"h-2"})]})]})})})]}),e.jsxs(i,{children:[e.jsx(v,{children:e.jsx(f,{children:"Governance Health Score"})}),e.jsx(n,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Decentralization"}),e.jsx("span",{className:"text-2xl font-bold text-green-500",children:"92"})]}),e.jsx(T,{value:92,className:"h-2"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Voting power well distributed across holders"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Engagement"}),e.jsx("span",{className:"text-2xl font-bold text-blue-500",children:"87"})]}),e.jsx(T,{value:87,className:"h-2"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"High community participation in voting"})]})]})})]})]})}const te=j.forwardRef(({className:s,...c},d)=>e.jsx(ye,{className:G("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...c,ref:d,children:e.jsx(Oe,{className:G("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));te.displayName=ye.displayName;function rs(){const{wallet:s}=M(),{toast:c}=z(),d=Q(),[p,x]=j.useState(!1),[N,S]=j.useState(null),{data:y,isLoading:k}=b({queryKey:["/api/yield/opportunities",s.address],enabled:!!s.address,refetchInterval:3e4}),{data:g}=b({queryKey:["/api/yield/strategies",s.address],enabled:!!s.address}),{data:C}=b({queryKey:["/api/yield/positions",s.address],enabled:!!s.address}),m=le({mutationFn:async a=>oe("/api/yield/optimize",{method:"POST",body:JSON.stringify({strategyId:a,userAddress:s.address,autoCompound:p})}),onSuccess:()=>{c({title:"Optimization Executed",description:"Your yield optimization has been successfully executed."}),d.invalidateQueries({queryKey:["/api/yield/opportunities"]}),d.invalidateQueries({queryKey:["/api/yield/positions"]})},onError:a=>{c({title:"Optimization Failed",description:a.message,variant:"destructive"})}}),V=a=>{switch(a){case"low":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},w=a=>{S(a),m.mutate(a)};return s.isConnected?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(se,{className:"w-5 h-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Potential Improvement"}),e.jsxs("p",{className:"text-2xl font-bold",children:["+",y?.totalImprovement||"0","%"]})]})]})})}),e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{className:"w-5 h-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Additional Annual Yield"}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",y?.additionalYield||"0"]})]})]})})}),e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qe,{className:"w-5 h-5 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Auto-Compound Boost"}),e.jsxs("p",{className:"text-2xl font-bold",children:["+",y?.compoundBoost||"0","%"]})]})]})})})]}),e.jsxs(i,{children:[e.jsx(v,{children:e.jsxs(f,{className:"flex items-center space-x-2",children:[e.jsx(ue,{className:"w-5 h-5"}),e.jsx("span",{children:"Auto-Optimization Settings"})]})}),e.jsxs(n,{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{id:"auto-optimize",checked:p,onCheckedChange:x}),e.jsx(U,{htmlFor:"auto-optimize",children:"Enable automatic yield optimization and compounding"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Automatically optimize your positions when better opportunities arise (gas costs apply)"})]})]}),e.jsxs(me,{defaultValue:"opportunities",className:"w-full",children:[e.jsxs(he,{className:"grid w-full grid-cols-3",children:[e.jsx(R,{value:"opportunities",children:"Opportunities"}),e.jsx(R,{value:"strategies",children:"Strategies"}),e.jsx(R,{value:"positions",children:"Current Positions"})]}),e.jsx($,{value:"opportunities",className:"space-y-4",children:e.jsx("div",{className:"space-y-4",children:k?e.jsx("div",{className:"text-center py-8",children:"Loading optimization opportunities..."}):(y?.opportunities||[]).map(a=>e.jsxs(i,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(K,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(f,{className:"text-lg",children:a.protocol}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.tokenPair," • ",a.type]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(h,{className:V(a.risk),children:[a.risk," risk"]}),e.jsxs(h,{variant:"outline",children:["TVL: ",a.tvl]})]})]})}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:a.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-muted-foreground",children:[a.currentAPY,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Current APY"})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(ze,{className:"w-6 h-6 text-muted-foreground"})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-500",children:[a.optimizedAPY,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Optimized APY"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Improvement"}),e.jsxs("span",{className:"text-lg font-bold text-green-500",children:["+",a.improvement,"%"]})]}),e.jsx(T,{value:a.improvement,className:"h-2"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-2",children:a.autoCompound&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-green-600",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{children:"Auto-compound"})]})}),e.jsx(u,{onClick:()=>w(a.id),disabled:m.isPending&&N===a.id,className:"flex items-center space-x-2",children:m.isPending&&N===a.id?e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Optimizing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:"Optimize"})]})})]})]})})]},a.id))})}),e.jsx($,{value:"strategies",className:"space-y-4",children:e.jsx("div",{className:"space-y-4",children:(g||[]).map(a=>e.jsxs(i,{children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{className:"text-lg",children:a.name}),e.jsx(h,{variant:a.enabled?"default":"outline",children:a.enabled?"Active":"Inactive"})]})}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:a.description}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Expected Improvement"}),e.jsxs("div",{className:"font-medium text-green-500",children:["+",a.expectedImprovement,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Gas Cost"}),e.jsx("div",{className:"font-medium",children:a.estimatedGas})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Frequency"}),e.jsx("div",{className:"font-medium",children:a.timeframe})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Complexity"}),e.jsx("div",{className:"font-medium capitalize",children:a.complexity})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{id:a.id,checked:a.enabled,onCheckedChange:A=>{c({title:`Strategy ${A?"Enabled":"Disabled"}`,description:`${a.name} has been ${A?"enabled":"disabled"}.`})}}),e.jsx(U,{htmlFor:a.id,children:"Enable Strategy"})]}),e.jsx(u,{variant:"outline",size:"sm",children:"Configure"})]})]})})]},a.id))})}),e.jsx($,{value:"positions",className:"space-y-4",children:e.jsx("div",{className:"space-y-4",children:(C||[]).map(a=>e.jsxs(i,{children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-500 rounded-lg flex items-center justify-center",children:e.jsx(P,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx(f,{className:"text-lg",children:a.protocol}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.tokenPair," • ",a.type]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[a.currentAPY,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Current APY"})]})]})}),e.jsxs(n,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Staked Amount"}),e.jsx("div",{className:"text-lg font-bold",children:a.amount})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Earned"}),e.jsx("div",{className:"text-lg font-bold text-green-500",children:a.earned})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Last Compound"}),e.jsx("div",{className:"text-lg font-bold",children:a.lastCompound})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx("div",{className:"flex items-center space-x-2",children:a.autoCompound?e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-green-600",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{children:"Auto-compound active"})]}):e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-yellow-600",children:[e.jsx(X,{className:"w-4 h-4"}),e.jsx("span",{children:"Manual compound needed"})]})}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(u,{variant:"outline",size:"sm",children:"Compound"}),e.jsx(u,{size:"sm",children:"Optimize"})]})]})]})]},a.id))})})]})]}):e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsx(i,{className:"text-center py-12",children:e.jsxs(n,{children:[e.jsx(K,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Connect Your Wallet"}),e.jsx("p",{className:"text-muted-foreground",children:"Connect your wallet to access yield optimization"})]})})})}function ls(){const{wallet:s}=M(),{toast:c}=z(),[d,p]=j.useState("7d"),[x,N]=j.useState("portfolio"),{data:S,isLoading:y}=b({queryKey:["/api/risk/analysis",s.address,d],enabled:!!s.address,refetchInterval:3e4}),{data:k}=b({queryKey:["/api/risk/alerts",s.address],enabled:!!s.address,refetchInterval:15e3}),{data:g}=b({queryKey:["/api/risk/portfolio",s.address],enabled:!!s.address}),{data:C}=b({queryKey:["/api/risk/market"],refetchInterval:1e4}),{data:m}=b({queryKey:["/api/security/status"],refetchInterval:5e3}),V=l=>{switch(l){case"safe":case"secure":return"text-green-500";case"warning":return"text-yellow-500";case"danger":case"critical":return"text-red-500";default:return"text-gray-500"}},w=l=>{switch(l){case"safe":case"secure":return"bg-green-100 text-green-800 border-green-200";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"danger":case"critical":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},a=l=>{switch(l){case"low":return e.jsx(q,{className:"w-5 h-5 text-blue-500"});case"medium":return e.jsx(X,{className:"w-5 h-5 text-yellow-500"});case"high":return e.jsx(B,{className:"w-5 h-5 text-red-500"});default:return e.jsx(q,{className:"w-5 h-5 text-gray-500"})}},A=async l=>{try{(await fetch(ke("/api/risk/mitigate/${alertId}"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userAddress:s.address})})).ok&&c({title:"Risk Mitigation Initiated",description:"Risk mitigation measures have been applied",variant:"default"})}catch{c({title:"Error",description:"Failed to initiate risk mitigation",variant:"destructive"})}};return s.isConnected?y?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-white"})})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center py-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Risk Management"}),e.jsx("p",{className:"text-gray-300",children:"Monitor and manage your portfolio risks and security"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(i,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-blue-500/20",children:e.jsx(se,{className:"w-6 h-6 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:"Risk Score"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:[g?.risk_score||72,"/100"]})]})]})})}),e.jsx(i,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-3 rounded-full ${m?.overall==="secure"?"bg-green-500/20":"bg-yellow-500/20"}`,children:e.jsx(O,{className:`w-6 h-6 ${V(m?.overall||"secure")}`})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:"Security Status"}),e.jsx(h,{className:w(m?.overall||"secure"),children:m?.overall?.toUpperCase()||"SECURE"})]})]})})}),e.jsx(i,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-yellow-500/20",children:e.jsx(X,{className:"w-6 h-6 text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:"Active Alerts"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:k?.filter(l=>l.severity==="high"||l.severity==="medium").length||3})]})]})})}),e.jsx(i,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-purple-500/20",children:e.jsx(Z,{className:"w-6 h-6 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:"Volatility"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:[C?.volatility_index||24,"%"]})]})]})})})]}),e.jsxs(me,{value:x,onValueChange:N,className:"w-full",children:[e.jsxs(he,{className:"grid w-full grid-cols-4 bg-black/20 border-white/10",children:[e.jsx(R,{value:"portfolio",className:"text-white data-[state=active]:bg-purple-500 data-[state=active]:text-white",children:"Portfolio Risk"}),e.jsx(R,{value:"security",className:"text-white data-[state=active]:bg-purple-500 data-[state=active]:text-white",children:"Security"}),e.jsx(R,{value:"market",className:"text-white data-[state=active]:bg-purple-500 data-[state=active]:text-white",children:"Market Risk"}),e.jsx(R,{value:"alerts",className:"text-white data-[state=active]:bg-purple-500 data-[state=active]:text-white",children:"Risk Alerts"})]}),e.jsx($,{value:"portfolio",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(i,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:[e.jsx(v,{children:e.jsxs(f,{className:"text-white flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Portfolio Risk Metrics"]})}),e.jsx(n,{className:"space-y-4",children:portfolioMetrics?.metrics?.map((l,t)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-white font-medium",children:l.name}),e.jsxs(h,{className:w(l.status),children:[l.value,"%"]})]}),e.jsx(T,{value:l.value,className:"h-2"}),e.jsx("p",{className:"text-gray-400 text-sm",children:l.description})]},t))||e.jsx("div",{className:"text-gray-400 text-center py-4",children:"Loading risk metrics..."})})]}),e.jsxs(i,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:[e.jsx(v,{children:e.jsx(f,{className:"text-white",children:"Risk Trend"})}),e.jsx(n,{children:e.jsx("div",{className:"h-64",children:e.jsx(je,{width:"100%",height:"100%",children:e.jsxs(We,{data:riskTrendData?.trend||[],children:[e.jsx(pe,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(ge,{dataKey:"timestamp",stroke:"#9CA3AF",tickFormatter:l=>new Date(l).toLocaleDateString()}),e.jsx(Ne,{stroke:"#9CA3AF"}),e.jsx(ve,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"8px",color:"#F9FAFB"},labelFormatter:l=>new Date(l).toLocaleString()}),e.jsx(He,{type:"monotone",dataKey:"risk",stroke:"#8B5CF6",strokeWidth:2,name:"Risk Score"})]})})})})]})]})}),e.jsx($,{value:"security",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(i,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:[e.jsx(v,{children:e.jsxs(f,{className:"text-white flex items-center gap-2",children:[e.jsx(O,{className:"w-5 h-5"}),"Security Systems"]})}),e.jsx(n,{className:"space-y-4",children:m?.systems&&Object.entries(m.systems).map(([l,t])=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-black/20 rounded-lg border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t?e.jsx(D,{className:"w-5 h-5 text-green-400"}):e.jsx(B,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:"text-white capitalize",children:l.replace(/_/g," ")})]}),e.jsx(h,{className:w(t?"secure":"critical"),children:t?"Active":"Inactive"})]},l))})]}),e.jsxs(i,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:[e.jsx(v,{children:e.jsxs(f,{className:"text-white flex items-center gap-2",children:[e.jsx(we,{className:"w-5 h-5"}),"Security Monitoring"]})}),e.jsxs(n,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:"97.8%"}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Success Rate"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:"47"}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Threats Blocked"})]})]}),e.jsxs(Xe,{className:"border-green-500/20 bg-green-500/10",children:[e.jsx(D,{className:"h-4 w-4 text-green-400"}),e.jsx(Be,{className:"text-green-300",children:"All security systems are operational and monitoring actively."})]})]})]})]})}),e.jsx($,{value:"market",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(i,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:[e.jsx(v,{children:e.jsxs(f,{className:"text-white flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5"}),"Market Risk Indicators"]})}),e.jsx(n,{className:"space-y-4",children:[{name:"Market Volatility",value:24,status:"warning",trend:"up"},{name:"Liquidity Depth",value:78,status:"safe",trend:"stable"},{name:"Price Impact",value:12,status:"safe",trend:"down"},{name:"Slippage Risk",value:8,status:"safe",trend:"stable"}].map((l,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-black/20 rounded-lg border border-white/10",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:l.name}),e.jsxs("div",{className:"text-gray-400 text-sm",children:[l.value,"%",l.trend==="up"&&e.jsx(P,{className:"w-3 h-3 inline ml-1 text-red-400"}),l.trend==="down"&&e.jsx(ee,{className:"w-3 h-3 inline ml-1 text-green-400"})]})]}),e.jsx(h,{className:w(l.status),children:l.status})]},t))})]}),e.jsxs(i,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:[e.jsx(v,{children:e.jsx(f,{className:"text-white",children:"Market Volatility Trend"})}),e.jsx(n,{children:e.jsx("div",{className:"h-64",children:e.jsx(je,{width:"100%",height:"100%",children:e.jsxs(Ze,{data:[{timestamp:Date.now()-864e5*6,volatility:18},{timestamp:Date.now()-864e5*5,volatility:22},{timestamp:Date.now()-864e5*4,volatility:19},{timestamp:Date.now()-864e5*3,volatility:26},{timestamp:Date.now()-864e5*2,volatility:24},{timestamp:Date.now()-864e5*1,volatility:21},{timestamp:Date.now(),volatility:24}],children:[e.jsx(pe,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(ge,{dataKey:"timestamp",stroke:"#9CA3AF"}),e.jsx(Ne,{stroke:"#9CA3AF"}),e.jsx(ve,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"8px",color:"#F9FAFB"}}),e.jsx(es,{type:"monotone",dataKey:"volatility",stroke:"#F59E0B",fill:"#F59E0B",fillOpacity:.2,name:"Volatility %"})]})})})})]})]})}),e.jsx($,{value:"alerts",className:"space-y-6",children:e.jsxs(i,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:[e.jsx(v,{children:e.jsxs(f,{className:"text-white flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5"}),"Active Risk Alerts"]})}),e.jsx(n,{className:"space-y-4",children:riskAlerts?.alerts?.map(l=>e.jsx("div",{className:"p-4 bg-black/20 rounded-lg border border-white/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[a(l.severity),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-white font-medium",children:l.title}),e.jsx(h,{className:`text-xs ${l.severity==="high"?"bg-red-100 text-red-800":l.severity==="medium"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:l.severity})]}),e.jsx("div",{className:"text-gray-300 text-sm mb-2",children:l.description}),e.jsxs("div",{className:"text-gray-400 text-xs mb-2",children:["Impact: ",l.impact]}),e.jsx("div",{className:"text-blue-300 text-xs",children:l.recommendation})]}),e.jsx(u,{size:"sm",onClick:()=>A(l.id),className:"bg-purple-500 hover:bg-purple-600",children:"Mitigate"})]})},l.id))})]})})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4",children:e.jsx("div",{className:"max-w-2xl mx-auto pt-20",children:e.jsx(i,{className:"bg-black/20 backdrop-blur-lg border-white/10",children:e.jsx(n,{className:"p-8 text-center",children:e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(O,{className:"w-8 h-8 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Connect Your Wallet"}),e.jsx("p",{className:"text-gray-300",children:"Connect your wallet to access risk management tools"})]})})})})})}function is({proposal:s,isOpen:c,onClose:d}){const{wallet:p}=M(),{toast:x}=z(),N=Q(),[S,y]=j.useState("for"),[k,g]=j.useState(""),C=le({mutationFn:async()=>oe("/api/governance/vote",{method:"POST",body:JSON.stringify({proposalId:s.id,vote:S,reason:k,userAddress:p.address})}),onSuccess:()=>{x({title:"Vote Submitted",description:`Your ${S} vote has been recorded.`}),d(),N.invalidateQueries({queryKey:["/api/governance/proposals"]})},onError:m=>{x({title:"Vote Failed",description:m.message,variant:"destructive"})}});return e.jsx(ie,{open:c,onOpenChange:d,children:e.jsxs(ne,{className:"max-w-md",children:[e.jsx(ce,{children:e.jsx(de,{children:"Vote on Proposal"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.description})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium",children:"Your Vote"}),e.jsxs(Ce,{value:S,onValueChange:m=>y(m),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{value:"for",id:"for"}),e.jsxs(U,{htmlFor:"for",className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-green-500"}),"Vote For"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{value:"against",id:"against"}),e.jsxs(U,{htmlFor:"against",className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4 text-red-500"}),"Vote Against"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Reason (Optional)"}),e.jsx(xe,{placeholder:"Explain your voting decision...",value:k,onChange:m=>g(m.target.value),className:"min-h-[80px]",maxLength:500}),e.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[k.length,"/500 characters"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950 rounded-lg border border-green-200 dark:border-green-800",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:s.votesFor}),e.jsx("div",{className:"text-xs text-green-600",children:"For"})]}),e.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-950 rounded-lg border border-red-200 dark:border-red-800",children:[e.jsx("div",{className:"text-lg font-bold text-red-600",children:s.votesAgainst}),e.jsx("div",{className:"text-xs text-red-600",children:"Against"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(u,{variant:"outline",className:"flex-1",onClick:d,children:"Cancel"}),e.jsx(u,{className:"flex-1",onClick:()=>C.mutate(),disabled:C.isPending,children:C.isPending?"Submitting...":`Vote ${S}`})]})]})]})})}function ns({isOpen:s,onClose:c}){const{wallet:d}=M(),{toast:p}=z(),x=Q(),[N,S]=j.useState("general"),[y,k]=j.useState(""),[g,C]=j.useState(""),[m,V]=j.useState(""),[w,a]=j.useState(""),A=le({mutationFn:async()=>oe("/api/governance/create-proposal",{method:"POST",body:JSON.stringify({type:N,title:y,description:g,details:{currentValue:m,proposedValue:w},proposer:d.address})}),onSuccess:()=>{p({title:"Proposal Created",description:"Your governance proposal has been submitted for community review."}),c(),k(""),C(""),V(""),a(""),x.invalidateQueries({queryKey:["/api/governance/proposals"]})},onError:t=>{p({title:"Creation Failed",description:"Failed to create proposal. Please try again.",variant:"destructive"})}});return e.jsx(ie,{open:s,onOpenChange:c,children:e.jsxs(ne,{className:"max-w-lg",children:[e.jsx(ce,{children:e.jsx(de,{children:"Create Governance Proposal"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-4 bg-orange-50 dark:bg-orange-950 rounded-lg border border-orange-200 dark:border-orange-800",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(q,{className:"w-5 h-5 text-orange-500 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium text-orange-700 dark:text-orange-300",children:"Requirements"}),e.jsxs("div",{className:"text-orange-600 dark:text-orange-400 mt-1",children:["Minimum ","10000"," XP tokens required to create a proposal"]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Proposal Type"}),e.jsxs(Ge,{value:N,onValueChange:t=>S(t),children:[e.jsx(Ue,{children:e.jsx(Qe,{})}),e.jsxs(_e,{children:[e.jsx(Y,{value:"parameter",children:"Parameter Change"}),e.jsx(Y,{value:"upgrade",children:"Protocol Upgrade"}),e.jsx(Y,{value:"treasury",children:"Treasury Proposal"}),e.jsx(Y,{value:"general",children:"General Proposal"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Title"}),e.jsx(J,{placeholder:"Brief, clear title for your proposal",value:y,onChange:t=>k(t.target.value),maxLength:100})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx(xe,{placeholder:"Detailed explanation of your proposal, its benefits, and implementation plan...",value:g,onChange:t=>C(t.target.value),className:"min-h-[120px]",maxLength:2e3}),e.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[g.length,"/2000 characters"]})]}),(N==="parameter"||N==="treasury")&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Current Value"}),e.jsx(J,{placeholder:"e.g., 0.3%",value:m,onChange:t=>V(t.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Proposed Value"}),e.jsx(J,{placeholder:"e.g., 0.25%",value:w,onChange:t=>a(t.target.value)})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(u,{variant:"outline",className:"flex-1",onClick:c,children:"Cancel"}),e.jsx(u,{className:"flex-1",onClick:()=>A.mutate(),disabled:!y||!g||A.isPending,children:A.isPending?"Creating...":"Create Proposal"})]})]})]})})}function cs(){const{wallet:s}=M();z(),Q();const[c,d]=j.useState("all"),[p,x]=j.useState(!1),[N,S]=j.useState(!1),[y,k]=j.useState(null),{data:g,isLoading:C}=b({queryKey:["/api/governance/proposals"],enabled:!!s.address,refetchInterval:5e3}),{data:m}=b({queryKey:["/api/governance/stats"],enabled:!!s.address}),{data:V}=b({queryKey:["/api/governance/risk-analysis"],enabled:!!s.address}),{data:w}=b({queryKey:["/api/governance/yield-optimization"],enabled:!!s.address}),{data:a}=b({queryKey:["/api/governance/voting-power",s.address],enabled:!!s.address,refetchInterval:1e4}),A=r=>{k(r),x(!0)},l=g?.filter(r=>c==="all"||r.status===c)||[],t=r=>{switch(r){case"active":return"bg-green-500";case"passed":return"bg-blue-500";case"rejected":return"bg-red-500";case"pending":return"bg-yellow-500";case"executed":return"bg-purple-500";default:return"bg-gray-500"}},o=r=>{switch(r){case"active":return e.jsx(E,{className:"w-4 h-4"});case"passed":return e.jsx(D,{className:"w-4 h-4"});case"rejected":return e.jsx(B,{className:"w-4 h-4"});case"pending":return e.jsx(Ke,{className:"w-4 h-4"});case"executed":return e.jsx(D,{className:"w-4 h-4"});default:return e.jsx(q,{className:"w-4 h-4"})}},Pe=r=>{switch(r){case"parameter":return e.jsx(Ye,{className:"w-4 h-4"});case"upgrade":return e.jsx(P,{className:"w-4 h-4"});case"treasury":return e.jsx(re,{className:"w-4 h-4"});case"general":return e.jsx(Ee,{className:"w-4 h-4"});default:return e.jsx(q,{className:"w-4 h-4"})}},Se=r=>{const _=Date.now(),F=r-_;if(F<=0)return"Ended";const L=Math.floor(F/(1e3*60*60*24)),I=Math.floor(F%(1e3*60*60*24)/(1e3*60*60));return L>0?`${L}d ${I}h left`:`${I}h left`},Ae=(r,_)=>{const F=parseFloat(r),L=parseFloat(_),I=F+L;return I===0?{forPercentage:0,againstPercentage:0}:{forPercentage:F/I*100,againstPercentage:L/I*100}};return s.isConnected?e.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Advanced DeFi Governance"}),e.jsx("p",{className:"text-muted-foreground",children:"Real-time governance, yield optimization, and risk management"})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs(u,{onClick:()=>S(!0),className:"flex items-center space-x-2",children:[e.jsx(Me,{className:"w-4 h-4"}),e.jsx("span",{children:"Create Proposal"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{className:"w-5 h-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Proposals"}),e.jsx("p",{className:"text-2xl font-bold",children:m?.totalProposals||0}),e.jsxs("p",{className:"text-xs text-green-500",children:["+",m?.newProposals||0," this week"]})]})]})})}),e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"w-5 h-5 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your Voting Power"}),e.jsx("p",{className:"text-2xl font-bold",children:a?.totalPower||"0"}),e.jsxs("p",{className:"text-xs text-blue-500",children:["Rank #",a?.rank||"N/A"]})]})]})})}),e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"w-5 h-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Risk Score"}),e.jsx("p",{className:"text-2xl font-bold",children:V?.overallRisk||"Low"}),e.jsx("p",{className:"text-xs text-green-500",children:"-5% from last week"})]})]})})}),e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{className:"w-5 h-5 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Optimized APY"}),e.jsx("p",{className:"text-2xl font-bold",children:w?.optimizedAPY||"0%"}),e.jsxs("p",{className:"text-xs text-purple-500",children:["+",w?.improvement||"0%"," boost"]})]})]})})})]}),e.jsxs(me,{defaultValue:"proposals",className:"w-full",children:[e.jsxs(he,{className:"grid w-full grid-cols-4",children:[e.jsx(R,{value:"proposals",children:"Proposals"}),e.jsx(R,{value:"analytics",children:"Analytics"}),e.jsx(R,{value:"yields",children:"Yield Optimization"}),e.jsx(R,{value:"risks",children:"Risk Management"})]}),e.jsxs($,{value:"proposals",className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(u,{variant:c==="all"?"default":"outline",onClick:()=>d("all"),children:"All Proposals"}),e.jsxs(u,{variant:c==="active"?"default":"outline",onClick:()=>d("active"),children:["Active (",m?.activeProposals||0,")"]}),e.jsx(u,{variant:c==="passed"?"default":"outline",onClick:()=>d("passed"),children:"Passed"}),e.jsx(u,{variant:c==="rejected"?"default":"outline",onClick:()=>d("rejected"),children:"Rejected"})]}),e.jsx("div",{className:"space-y-4",children:C?e.jsx("div",{className:"text-center py-8",children:"Loading proposals..."}):l.length===0?e.jsx(i,{children:e.jsxs(n,{className:"py-8 text-center",children:[e.jsx(q,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"No proposals found"})]})}):l.map(r=>e.jsxs(i,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[Pe(r.type),e.jsxs("div",{children:[e.jsx(f,{className:"text-lg",children:r.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Proposed by ",r.proposer.slice(0,8),"...",r.proposer.slice(-6)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(h,{className:t(r.status),children:[o(r.status),e.jsx("span",{className:"ml-1 capitalize",children:r.status})]}),e.jsx(h,{variant:"outline",children:r.type})]})]})}),e.jsxs(n,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:r.description}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-green-600",children:["For: ",r.votesFor]}),e.jsxs("span",{className:"text-red-600",children:["Against: ",r.votesAgainst]})]}),e.jsx(T,{value:Ae(r.votesFor,r.votesAgainst).forPercentage,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Quorum: ",r.quorum]}),e.jsx("span",{children:Se(r.endTime)})]})]}),r.details&&e.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg mb-4 space-y-2",children:[r.details.currentValue&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Current Value:"}),e.jsx("span",{className:"font-medium",children:r.details.currentValue})]}),r.details.proposedValue&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Proposed Value:"}),e.jsx("span",{className:"font-medium text-blue-600",children:r.details.proposedValue})]}),r.details.impact&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Impact: "}),e.jsx("span",{children:r.details.impact})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{size:"sm",onClick:()=>A(r),disabled:r.status!=="active"||r.userVote!==null,children:r.userVote?`Voted ${r.userVote}`:"Vote Now"}),e.jsxs(u,{size:"sm",variant:"outline",children:[e.jsx(we,{className:"w-4 h-4 mr-1"}),"Details"]}),e.jsx(as,{insight:{id:r.id.toString(),type:"analysis",title:r.title,description:r.description,data:{tokenA:"XP",amount:r.votesFor,price:"0.01659"},timestamp:Date.now()}})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[e.jsx(Le,{className:"w-4 h-4"}),e.jsxs("span",{children:["Ends ",new Date(r.endTime).toLocaleDateString()]})]})]})]})]},r.id))})]}),e.jsx($,{value:"analytics",className:"space-y-4",children:e.jsx(ts,{})}),e.jsx($,{value:"yields",className:"space-y-4",children:e.jsx(rs,{})}),e.jsx($,{value:"risks",className:"space-y-4",children:e.jsx(ls,{})})]}),y&&e.jsx(is,{proposal:y,isOpen:p,onClose:()=>{x(!1),k(null)}}),e.jsx(ns,{isOpen:N,onClose:()=>S(!1)})]}):e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsx(i,{className:"text-center py-12",children:e.jsxs(n,{children:[e.jsx(E,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Connect Your Wallet"}),e.jsx("p",{className:"text-muted-foreground",children:"Connect your wallet to participate in governance voting"})]})})})}function ws(){const{data:s}=b({queryKey:["/api/governance/stats"],queryFn:async()=>{const c=await fetch(ke("/api/governance/stats"));if(!c.ok)throw new Error("Failed to fetch governance stats");return c.json()}});return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Community Governance"}),e.jsx("p",{className:"text-muted-foreground",children:"Participate in shaping the future of XpSwap through decentralized governance"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(i,{children:e.jsxs(n,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Total Proposals"}),e.jsx(E,{className:"w-4 h-4 text-blue-500"})]}),e.jsx("div",{className:"text-2xl font-bold",children:s?.totalProposals||0}),e.jsx(h,{variant:"outline",className:"text-blue-600 border-blue-200",children:"All Time"})]})}),e.jsx(i,{children:e.jsxs(n,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Active Votes"}),e.jsx(H,{className:"w-4 h-4 text-green-500"})]}),e.jsx("div",{className:"text-2xl font-bold",children:s?.activeProposals||0}),e.jsx(h,{variant:"outline",className:"text-green-600 border-green-200",children:"Ongoing"})]})}),e.jsx(i,{children:e.jsxs(n,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Participation"}),e.jsx(P,{className:"w-4 h-4 text-purple-500"})]}),e.jsxs("div",{className:"text-2xl font-bold",children:[s?.participationRate||0,"%"]}),e.jsx(h,{variant:"outline",className:"text-purple-600 border-purple-200",children:"30 Days"})]})}),e.jsx(i,{children:e.jsxs(n,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Success Rate"}),e.jsx(O,{className:"w-4 h-4 text-orange-500"})]}),e.jsxs("div",{className:"text-2xl font-bold",children:[s?.successRate||0,"%"]}),e.jsx(h,{variant:"outline",className:"text-orange-600 border-orange-200",children:"Passed"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(i,{children:e.jsxs(n,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:e.jsx(E,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h3",{className:"font-semibold",children:"Token-based Voting"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your voting power is determined by your XP token holdings. More tokens mean more influence on governance decisions."})]})}),e.jsx(i,{children:e.jsxs(n,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center",children:e.jsx(H,{className:"w-5 h-5 text-green-600"})}),e.jsx("h3",{className:"font-semibold",children:"Community Proposals"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Any XP holder can create proposals for protocol changes, upgrades, and treasury management with sufficient stake."})]})}),e.jsx(i,{children:e.jsxs(n,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center",children:e.jsx(O,{className:"w-5 h-5 text-purple-600"})}),e.jsx("h3",{className:"font-semibold",children:"Transparent Execution"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"All governance decisions are executed on-chain with full transparency and immutable records."})]})})]}),e.jsx(cs,{})]})}export{ws as default};
