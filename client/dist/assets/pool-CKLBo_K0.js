import{ap as se,r as c,F as M,aq as G,j as e,ab as we,aP as W,aT as Ae,ad as O,a9 as ke,at as Pe,v as Le,aK as Fe,aC as ce,aU as Se}from"./react-CnjVYTDc.js";import{f as Z,u as ae,g as C,D as te,h as le,i as ne,j as re,B as p,d as A,C as g,a as w}from"./index-DxHLzNoH.js";import{I}from"./input-BJWVzqi3.js";import{T as je,a as fe,b as V,c as Q}from"./tabs-1rBqboxz.js";import{S as oe,a as me,b as xe,c as ue,d as he}from"./select-CKrfnZoO.js";import{W as qe}from"./WalletSelector-Bly2x6nt.js";import{u as Be}from"./useTokenPrices-DtKVxnmy.js";import{g as L}from"./tokenUtils-CIcLq7dT.js";import{w as Te}from"./web3-30Ii_1H8.js";import"./vendor-B0r8BCsL.js";import"./utils-BkLtITBR.js";import"./ui-BQCqNqg0.js";import"./router-B_5Dh3-u.js";function Ce({pool:s,isOpen:u,onClose:x}){const{wallet:i}=Z(),{toast:N}=ae(),v=se(),[r,y]=c.useState(""),[j,o]=c.useState(""),[b,l]=c.useState("0.5"),[f,k]=c.useState(!0),{data:m}=Be([s.tokenA.symbol,s.tokenB.symbol]),{data:h}=M({queryKey:[`/api/blockchain/balance/${i.address}/${s.tokenA.symbol}`,i.address,s.tokenA.symbol],enabled:!!i.address&&!!s.tokenA.symbol,refetchInterval:5e3}),{data:P}=M({queryKey:[`/api/blockchain/balance/${i.address}/${s.tokenB.symbol}`,i.address,s.tokenB.symbol],enabled:!!i.address&&!!s.tokenB.symbol,refetchInterval:5e3}),F=G({mutationFn:async()=>{if(!i.address)throw new Error("Wallet not connected");const n=await fetch(C("/api/add-liquidity"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({poolId:s.id,tokenA:s.tokenA.symbol,tokenB:s.tokenB.symbol,amountA:r,amountB:j,slippage:parseFloat(b),userAddress:i.address})});if(!n.ok){const S=await n.json();throw new Error(S.error||"Failed to add liquidity")}return n.json()},onSuccess:()=>{N({title:"Liquidity Added",description:`Successfully added ${r} ${s.tokenA.symbol} and ${j} ${s.tokenB.symbol} to the pool`}),y(""),o(""),x(),v.invalidateQueries({queryKey:["/api/pools"]})},onError:n=>{N({title:"Add Liquidity Failed",description:n instanceof Error?n.message:"Unknown error occurred",variant:"destructive"})}});c.useEffect(()=>{if(f&&r&&s.reserveA&&s.reserveB){const n=parseFloat(s.reserveB)/parseFloat(s.reserveA),S=(parseFloat(r)*n).toFixed(6);o(S)}},[r,f,s.reserveA,s.reserveB]),c.useEffect(()=>{if(f&&j&&s.reserveA&&s.reserveB){const n=parseFloat(s.reserveA)/parseFloat(s.reserveB),S=(parseFloat(j)*n).toFixed(6);y(S)}},[j,f,s.reserveA,s.reserveB]);const K=m?.[s.tokenA.symbol]||0,q=m?.[s.tokenB.symbol]||0,$=(parseFloat(r||"0")*K).toFixed(2),X=(parseFloat(j||"0")*q).toFixed(2),B=(parseFloat($)+parseFloat(X)).toFixed(2),E=parseFloat(s.tvl.replace(/[,$]/g,"")),_=E>0?(parseFloat(B)/E*100).toFixed(6):"0",z=parseFloat(s.reserveA||"0"),T=parseFloat(s.reserveB||"0"),H=parseFloat(r||"0"),D=parseFloat(j||"0");let Y="0";if(z>0&&T>0&&H>0&&D>0){const n=z/T,S=(z+H)/(T+D);Y=(Math.abs(n-S)/n*100).toFixed(2)}const U=()=>{h?.balance&&y(h.balance)},J=()=>{P?.balance&&o(P.balance)};return e.jsx(te,{open:u,onOpenChange:x,children:e.jsxs(le,{className:"max-w-md",children:[e.jsx(ne,{children:e.jsx(re,{children:"Add Liquidity"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Amount ",s.tokenA.symbol]}),h?.balance&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Balance: ",h.balance,e.jsx(p,{variant:"link",size:"sm",className:"h-auto p-0 ml-1",onClick:U,children:"MAX"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{type:"number",placeholder:"0.0",value:r,onChange:n=>y(n.target.value),className:"pr-20"}),e.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-1",children:[e.jsx("img",{src:L(s.tokenA.symbol),alt:s.tokenA.symbol,className:"w-5 h-5 rounded-full"}),e.jsx("span",{className:"text-sm font-medium",children:s.tokenA.symbol})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["??$",$]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"p-2 rounded-full bg-muted",children:e.jsx(we,{className:"w-4 h-4"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Amount ",s.tokenB.symbol]}),P?.balance&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Balance: ",P.balance,e.jsx(p,{variant:"link",size:"sm",className:"h-auto p-0 ml-1",onClick:J,children:"MAX"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{type:"number",placeholder:"0.0",value:j,onChange:n=>o(n.target.value),className:"pr-20"}),e.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-1",children:[e.jsx("img",{src:L(s.tokenB.symbol),alt:s.tokenB.symbol,className:"w-5 h-5 rounded-full"}),e.jsx("span",{className:"text-sm font-medium",children:s.tokenB.symbol})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["??$",X]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Pool Share"}),e.jsxs("span",{children:[_,"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Total Value"}),e.jsxs("span",{children:["$",B]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Price Impact"}),e.jsxs(A,{variant:parseFloat(Y)>3?"destructive":"secondary",children:[Y,"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Current APR"}),e.jsxs(A,{variant:"secondary",className:"text-green-600",children:[s.apr,"%"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"optimal-ratio",checked:f,onChange:n=>k(n.target.checked),className:"rounded"}),e.jsx("label",{htmlFor:"optimal-ratio",className:"text-sm font-medium",children:"Maintain optimal ratio"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Reserve Ratio: ",s.reserveA&&s.reserveB?(parseFloat(s.reserveA)/parseFloat(s.reserveB)).toFixed(6):"N/A"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Slippage Tolerance"}),e.jsxs("div",{className:"flex gap-2",children:[["0.1","0.5","1.0"].map(n=>e.jsxs(p,{variant:b===n?"default":"outline",size:"sm",onClick:()=>l(n),children:[n,"%"]},n)),e.jsx(I,{placeholder:"Custom",value:b,onChange:n=>l(n.target.value),className:"w-20",type:"number"})]})]}),e.jsx(p,{className:"w-full",onClick:()=>F.mutate(),disabled:!r||!j||F.isPending,children:F.isPending?"Adding Liquidity...":"Add Liquidity"})]})]})})}function Re({pool:s,isOpen:u,onClose:x}){const{wallet:i}=Z(),{toast:N}=ae(),v=se(),[r,y]=c.useState("25"),[j,o]=c.useState(""),[b,l]=c.useState(""),f=G({mutationFn:async()=>{const m=await fetch(C("/api/remove-liquidity"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({poolId:s.id,percentage:parseFloat(r),userAddress:i.address})});if(!m.ok)throw new Error("Failed to remove liquidity");return m.json()},onSuccess:()=>{N({title:"Liquidity Removed",description:`Successfully removed ${r}% of your liquidity`}),x(),v.invalidateQueries({queryKey:["/api/pools"]})},onError:m=>{N({title:"Remove Liquidity Failed",description:"Failed to remove liquidity. Please try again.",variant:"destructive"})}}),k=m=>{if(!s.reserveA||!s.reserveB||!s.userLiquidity)return{amountA:"0",amountB:"0"};const h=parseFloat(s.reserveA),P=parseFloat(s.reserveB),F=parseFloat(s.userLiquidity),K=parseFloat(s.lpTokens)||1e5,q=F/K,$=h*q,X=P*q,B=$*(m/100),E=X*(m/100);return{amountA:B.toFixed(6),amountB:E.toFixed(6)}};return c.useEffect(()=>{const m=parseFloat(r),h=k(m);o(h.amountA),l(h.amountB)},[r,s.reserveA,s.reserveB,s.userLiquidity,s.lpTokens]),e.jsx(te,{open:u,onOpenChange:x,children:e.jsxs(le,{className:"max-w-md",children:[e.jsx(ne,{children:e.jsx(re,{children:"Remove Liquidity"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold",children:[r,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Remove liquidity"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:["25","50","75","100"].map(m=>e.jsxs(p,{variant:r===m?"default":"outline",size:"sm",onClick:()=>y(m),children:[m,"%"]},m))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-medium",children:"You will receive:"}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:L(s.tokenA.symbol),alt:s.tokenA.symbol,className:"w-6 h-6 rounded-full"}),e.jsx("span",{className:"font-medium",children:s.tokenA.symbol})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"font-medium",children:j})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:L(s.tokenB.symbol),alt:s.tokenB.symbol,className:"w-6 h-6 rounded-full"}),e.jsx("span",{className:"font-medium",children:s.tokenB.symbol})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"font-medium",children:b})})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Your Pool Share"}),e.jsx("span",{children:s.userLiquidity})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Total Pool TVL"}),e.jsx("span",{children:s.tvl})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Pool APR"}),e.jsxs("span",{className:"text-green-600",children:[s.apr,"%"]})]})]}),e.jsx(p,{className:"w-full",onClick:()=>f.mutate(),disabled:f.isPending,children:f.isPending?"Removing Liquidity...":"Remove Liquidity"})]})]})})}function ee({pool:s,onAddLiquidity:u,onRemoveLiquidity:x}){const i=N=>{const v=parseFloat(N.replace(/,/g,""));return v>=1e6?`$${(v/1e6).toFixed(1)}M`:v>=1e3?`$${(v/1e3).toFixed(0)}K`:`$${v.toLocaleString()}`};return e.jsx(g,{className:"hover:shadow-lg transition-shadow",children:e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center -space-x-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-background overflow-hidden",children:e.jsx("img",{src:L(s.tokenA.symbol),alt:s.tokenA.symbol,className:"w-full h-full object-cover"})}),e.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-background overflow-hidden",children:e.jsx("img",{src:L(s.tokenB.symbol),alt:s.tokenB.symbol,className:"w-full h-full object-cover"})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold",children:[s.tokenA.symbol,"/",s.tokenB.symbol]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Fee: ",s.feeRate,"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-8 text-right",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"TVL"}),e.jsx("p",{className:"font-semibold",children:i(s.tvl)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"APR"}),e.jsxs(A,{variant:"secondary",className:"text-green-600",children:[s.apr,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"24h Volume"}),e.jsx("p",{className:"font-semibold",children:i(s.volume24h)})]}),e.jsxs("div",{className:"space-x-2",children:[e.jsxs(p,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>u(s),children:[e.jsx(W,{className:"w-4 h-4 mr-1"}),"Add"]}),e.jsxs(p,{size:"sm",variant:"outline",onClick:()=>x(s),children:[e.jsx(Ae,{className:"w-4 h-4 mr-1"}),"Remove"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Reserve ",s.tokenA.symbol]}),e.jsx("p",{className:"font-medium",children:s.reserveA})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Reserve ",s.tokenB.symbol]}),e.jsx("p",{className:"font-medium",children:s.reserveB})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"24h Fees Earned"}),e.jsx("p",{className:"font-medium",children:i(s.fees24h)})]})]})]})})}function Me(){const{wallet:s}=Z(),[u,x]=c.useState(null),[i,N]=c.useState(!1),[v,r]=c.useState(!1),{data:y,isLoading:j}=M({queryKey:["/api/pools"],enabled:!!s.address}),o=l=>{x(l),N(!0)},b=l=>{x(l),r(!0)};return s.isConnected?j?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((l,f)=>e.jsx("div",{className:"h-32 bg-muted/50 rounded-lg animate-pulse"},f))}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Liquidity Pools"}),e.jsx("p",{className:"text-muted-foreground",children:"Provide liquidity and earn fees from trades"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4 text-green-600"}),e.jsxs("span",{children:["Active Pools: ",y?.length||0]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:"Real-time AMM"})]})]})]}),e.jsxs(je,{defaultValue:"all",className:"space-y-4",children:[e.jsxs(fe,{children:[e.jsx(V,{value:"all",children:"All Pools"}),e.jsx(V,{value:"my-pools",children:"My Positions"}),e.jsx(V,{value:"high-apr",children:"High APR"})]}),e.jsx(Q,{value:"all",className:"space-y-4",children:y?.map(l=>e.jsx(ee,{pool:l,onAddLiquidity:o,onRemoveLiquidity:b},l.id))}),e.jsx(Q,{value:"my-pools",className:"space-y-4",children:y?.filter(l=>parseFloat(l.userLiquidity)>0).map(l=>e.jsx(ee,{pool:l,onAddLiquidity:o,onRemoveLiquidity:b},l.id))}),e.jsx(Q,{value:"high-apr",className:"space-y-4",children:y?.filter(l=>parseFloat(l.apr)>=50).map(l=>e.jsx(ee,{pool:l,onAddLiquidity:o,onRemoveLiquidity:b},l.id))})]}),u&&e.jsx(Ce,{pool:u,isOpen:i,onClose:()=>{N(!1),x(null)}}),u&&e.jsx(Re,{pool:u,isOpen:v,onClose:()=>{r(!1),x(null)}})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Liquidity Pools"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Connect your wallet to manage liquidity pools"}),e.jsx(qe,{})]})}function Je(){const{wallet:s}=Z(),{toast:u}=ae(),x=se(),[i,N]=c.useState(""),[v,r]=c.useState(!1),[y,j]=c.useState(null),[o,b]=c.useState(""),[l,f]=c.useState(""),[k,m]=c.useState(""),[h,P]=c.useState(""),[F,K]=c.useState({}),{data:q=[],isLoading:$}=M({queryKey:["pools"],queryFn:async()=>{try{const a=await fetch(C("api/pools"));if(!a.ok)throw console.error("Pool API error:",a.status,a.statusText),new Error(`Failed to fetch pools: ${a.status}`);const t=await a.json();return console.log("Pool data received:",t),t.map(d=>({id:d.id,tokenA:d.pair?.tokenA||{symbol:"XP",name:"Xphere",address:"0x0"},tokenB:d.pair?.tokenB||{symbol:"USDT",name:"Tether USD",address:"0x0"},tvl:d.totalLiquidity||"0",apr:d.apr||"0",volume24h:d.pair?.volume24h||"0",fees24h:(parseFloat(d.pair?.volume24h||"0")*.003).toString(),userLiquidity:"0",userRewards:"0",reserveA:d.pair?.liquidityTokenA||"0",reserveB:d.pair?.liquidityTokenB||"0",lpTokens:"100000",feeRate:"0.3"}))}catch(a){throw console.error("Pool fetch error:",a),a}}}),X=q.filter(a=>a.tokenA?.symbol?.toLowerCase().includes(i.toLowerCase())||a.tokenB?.symbol?.toLowerCase().includes(i.toLowerCase())||a.tokenA?.name?.toLowerCase().includes(i.toLowerCase())||a.tokenB?.name?.toLowerCase().includes(i.toLowerCase())),B=[{symbol:"XP",name:"Xphere Token",address:"0x0000000000000000000000000000000000000000"},{symbol:"XPS",name:"XpSwap Token",address:"0xf1bA1aF6fae54C0f9d82C1d12aeF0c57543F12e2"},{symbol:"USDT",name:"Tether USD",address:"0xdac17f958d2ee523a2206206994597c13d831ec7"},{symbol:"USDC",name:"USD Coin",address:"0xa0b86a33e6df7febb86fdb5b8a2e6cc17a8db6bb"},{symbol:"ETH",name:"Ethereum",address:"0x0000000000000000000000000000000000000000"},{symbol:"BTC",name:"Bitcoin",address:"0x2260fac5e5542a773aa44fbcfedf7c193bc2c599"}],E=async()=>{if(!s.address)return;const a={};for(const t of B)try{if(t.symbol==="XP")a[t.symbol]=s.balance;else if(t.symbol==="XPS"){const d=await Te.getXPSBalance(s.address);a[t.symbol]=d}else a[t.symbol]="0"}catch(d){console.error(`Failed to fetch ${t.symbol} balance:`,d),a[t.symbol]="0"}K(a)};c.useEffect(()=>{s.address&&E()},[s.address]);const{data:_=[],isLoading:z}=M({queryKey:["lp-tokens"],queryFn:async()=>{const a=await fetch(C("/api/lp-tokens"));if(!a.ok)throw new Error("Failed to fetch LP tokens");return a.json()}}),{data:T=[],isLoading:H}=M({queryKey:["lp-holdings",s.address],queryFn:async()=>{if(!s.address)return[];const a=await fetch(C(`/api/lp-holdings?userAddress=${s.address}`));if(!a.ok)throw new Error("Failed to fetch LP holdings");return a.json()},enabled:!!s.address}),{data:D=[],isLoading:Y}=M({queryKey:["lp-rewards",s.address],queryFn:async()=>{if(!s.address)return[];const a=await fetch(C("/api/lp-rewards?userAddress=${wallet.address}"));if(!a.ok)throw new Error("Failed to fetch LP rewards");return a.json()},enabled:!!s.address}),U=G({mutationFn:async a=>{const t=await fetch(C("/api/lp-tokens/mint"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok)throw new Error("Failed to add liquidity");return t.json()},onSuccess:a=>{u({title:"LP Token Minted",description:`Successfully created ${a.amount} LP tokens. You'll receive XPS rewards!`,variant:"default"}),r(!1),b(""),f(""),m(""),P(""),x.invalidateQueries({queryKey:["lp-tokens"]}),x.invalidateQueries({queryKey:["lp-holdings",s.address]}),x.invalidateQueries({queryKey:["lp-rewards",s.address]})},onError:a=>{u({title:"LP Token Creation Failed",description:a.message,variant:"destructive"})}}),J=G({mutationFn:async({lpTokenId:a})=>{const t=await fetch(C("/api/lp-rewards/claim"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userAddress:s.address,lpTokenId:a})});if(!t.ok)throw new Error("Failed to claim LP rewards");return t.json()},onSuccess:a=>{u({title:"LP Rewards Claimed",description:`Successfully claimed ${a.totalRewards} XPS tokens!`,variant:"default"}),x.invalidateQueries({queryKey:["lp-rewards",s.address]}),x.invalidateQueries({queryKey:["lp-holdings",s.address]})},onError:a=>{u({title:"Reward Claim Failed",description:a.message,variant:"destructive"})}}),n=()=>{if(!o||!l||!k||!h){u({title:"Missing Information",description:"Please select tokens and enter amounts.",variant:"destructive"});return}const a={pairId:1,userAddress:s.address,amount:(parseFloat(k)*parseFloat(h)/2).toFixed(6),tokenAAmount:k,tokenBAmount:h};U.mutate(a)},S=a=>{J.mutate({lpTokenId:a})},pe=()=>D.filter(a=>!a.claimed).reduce((a,t)=>a+parseFloat(t.rewardAmount),0),ve=a=>{const t=typeof a=="string"?parseFloat(a):a;return new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:6}).format(t)},R=a=>{const t=parseFloat(a);return t===0?"0":t<1e-6?"< 0.000001":ve(t)},ye=a=>D.filter(t=>t.lpTokenId===a&&!t.claimed),be=a=>ye(a).reduce((t,d)=>t+parseFloat(d.rewardAmount),0),ie=()=>{q.length>0&&(j(q[0]),b("XP"),f("XPS"),r(!0))},de=(a,t)=>{const d=F[a]||"0";t?m(d):P(d)};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsx(g,{className:"bg-gradient-to-r from-green-500 via-emerald-500 to-teal-500 text-white border-0",children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",children:e.jsx(Pe,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-xl font-bold mb-1",children:"XPS Holder LP Boost"}),e.jsx("p",{className:"text-green-100 text-sm",children:"XPS staking increases LP rewards up to 2.5x"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(A,{variant:"secondary",className:"bg-white/20 text-white border-white/30",children:"LP Mining Boost"}),e.jsxs(p,{variant:"secondary",className:"bg-white text-green-600 hover:bg-white/90",onClick:()=>window.location.href="/documentation#xps-whitepaper",children:["Learn More ",e.jsx(Le,{className:"w-4 h-4 ml-2"})]})]})]})})})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Liquidity Pools"}),e.jsx("p",{className:"text-muted-foreground",children:"Provide liquidity to earn trading fees and rewards"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(g,{children:e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Total Value Locked"}),e.jsx(O,{className:"w-4 h-4 text-green-500"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"$10.1M"}),e.jsx(A,{variant:"outline",className:"text-green-600 border-green-200",children:"+15.2%"})]})}),e.jsx(g,{children:e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"24h Volume"}),e.jsx(O,{className:"w-4 h-4 text-blue-500"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"$3.6M"}),e.jsx(A,{variant:"outline",className:"text-blue-600 border-blue-200",children:"+8.7%"})]})}),e.jsx(g,{children:e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"24h Fees"}),e.jsx(O,{className:"w-4 h-4 text-purple-500"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"$10.9K"}),e.jsx(A,{variant:"outline",className:"text-purple-600 border-purple-200",children:"+12.3%"})]})}),e.jsx(g,{children:e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Active Pools"}),e.jsx(O,{className:"w-4 h-4 text-orange-500"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"12"}),e.jsx(A,{variant:"outline",className:"text-orange-600 border-orange-200",children:"+2 New"})]})})]}),e.jsxs(je,{defaultValue:"all-pools",className:"space-y-6",children:[e.jsxs(fe,{className:"grid w-full grid-cols-2",children:[e.jsx(V,{value:"all-pools",children:"All Pools"}),e.jsx(V,{value:"my-liquidity",children:"My Liquidity"})]}),e.jsxs(Q,{value:"all-pools",className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Fe,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(I,{placeholder:"Search pools by token symbol or name",value:i,onChange:a=>N(a.target.value),className:"pl-10"})]}),$?e.jsx("div",{className:"text-center py-8",children:"Loading pools..."}):e.jsx(Me,{pools:X})]}),e.jsxs(Q,{value:"my-liquidity",className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(p,{onClick:ie,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Add Liquidity"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(g,{children:e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Total LP Tokens"}),e.jsx(O,{className:"w-4 h-4 text-green-500"})]}),e.jsx("div",{className:"text-2xl font-bold",children:T.length}),e.jsx(A,{variant:"outline",className:"text-green-600 border-green-200",children:"Active"})]})}),e.jsx(g,{children:e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Unclaimed XPS Rewards"}),e.jsx(ce,{className:"w-4 h-4 text-yellow-500"})]}),e.jsx("div",{className:"text-2xl font-bold",children:R(pe().toString())}),e.jsx(A,{variant:"outline",className:"text-yellow-600 border-yellow-200",children:"XPS"})]})}),e.jsx(g,{children:e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"LP Positions"}),e.jsx(Se,{className:"w-4 h-4 text-purple-500"})]}),e.jsx("div",{className:"text-2xl font-bold",children:T.filter(a=>parseFloat(a.balance)>0).length}),e.jsx(A,{variant:"outline",className:"text-purple-600 border-purple-200",children:"Active"})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"My LP Token Holdings"}),H?e.jsx("div",{className:"text-center py-8",children:"Loading LP holdings..."}):T.length>0?e.jsx("div",{className:"space-y-4",children:T.map(a=>{const t=_.find(ge=>ge.id===a.lpTokenId),d=be(a.lpTokenId),Ne=d>0;return e.jsx(g,{children:e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"LP"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:t?.symbol||"LP Token"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t?.name||"LP Token"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold",children:R(a.balance)}),e.jsxs("p",{className:"text-sm text-green-600",children:[R(a.totalRewardsClaimed)," XPS claimed"]})]}),e.jsx("div",{className:"flex gap-2",children:Ne&&e.jsxs(p,{size:"sm",variant:"outline",onClick:()=>S(a.lpTokenId),disabled:J.isPending,className:"bg-yellow-50 text-yellow-600 hover:bg-yellow-100",children:[e.jsx(ce,{className:"w-4 h-4 mr-1"}),"Claim ",R(d.toString())," XPS"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"LP Balance"}),e.jsx("p",{className:"font-medium",children:R(a.balance)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Staked Balance"}),e.jsx("p",{className:"font-medium",children:R(a.stakedBalance)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pending Rewards"}),e.jsxs("p",{className:"font-medium text-yellow-600",children:[R(d.toString())," XPS"]})]})]})]})},a.id)})}):e.jsx(g,{children:e.jsx(w,{className:"p-12 text-center",children:e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(W,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No LP Tokens Yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Add liquidity to pools to start earning XPS rewards"}),e.jsx(p,{onClick:ie,className:"bg-green-600 hover:bg-green-700",children:"Add Your First Liquidity"})]})})})]})]})]}),y&&e.jsx(te,{open:v,onOpenChange:r,children:e.jsxs(le,{className:"max-w-md",children:[e.jsx(ne,{children:e.jsx(re,{children:"Add Liquidity"})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[e.jsxs("div",{className:"flex items-center -space-x-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-background overflow-hidden",children:e.jsx("img",{src:L(o),alt:o,className:"w-full h-full object-cover"})}),e.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-background overflow-hidden",children:e.jsx("img",{src:L(l),alt:l,className:"w-full h-full object-cover"})})]}),e.jsxs("div",{className:"text-lg font-semibold",children:[o||"Select","/",l||"Select"]})]}),e.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:"Add liquidity to earn trading fees and XPS rewards"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Token A"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Balance: ",o?parseFloat(F[o]||"0").toFixed(3):"0.000"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(I,{placeholder:"0.0",className:"text-xl font-semibold",type:"number",value:k,onChange:a=>m(a.target.value)}),e.jsx(p,{variant:"outline",size:"sm",onClick:()=>o&&de(o,!0),children:"MAX"})]}),e.jsxs(oe,{value:o,onValueChange:b,children:[e.jsx(me,{className:"w-full",children:e.jsx(xe,{placeholder:"Select Token A"})}),e.jsx(ue,{children:B.map(a=>e.jsx(he,{value:a.symbol,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("img",{src:L(a.symbol),alt:a.symbol,className:"w-5 h-5 rounded-full"}),e.jsx("span",{children:a.symbol}),e.jsx("span",{className:"text-muted-foreground text-xs",children:a.name})]})},a.symbol))})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(W,{className:"w-6 h-6 text-muted-foreground"})}),e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Token B"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Balance: ",l?parseFloat(F[l]||"0").toFixed(3):"0.000"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(I,{placeholder:"0.0",className:"text-xl font-semibold",type:"number",value:h,onChange:a=>P(a.target.value)}),e.jsx(p,{variant:"outline",size:"sm",onClick:()=>l&&de(l,!1),children:"MAX"})]}),e.jsxs(oe,{value:l,onValueChange:f,children:[e.jsx(me,{className:"w-full",children:e.jsx(xe,{placeholder:"Select Token B"})}),e.jsx(ue,{children:B.map(a=>e.jsx(he,{value:a.symbol,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("img",{src:L(a.symbol),alt:a.symbol,className:"w-5 h-5 rounded-full"}),e.jsx("span",{children:a.symbol}),e.jsx("span",{className:"text-muted-foreground text-xs",children:a.name})]})},a.symbol))})]})]})]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"rounded-lg bg-muted p-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{children:"Pool Share"}),e.jsx("span",{className:"font-semibold",children:k&&h?"~0.001%":"0%"})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{children:"Base APR"}),e.jsx("span",{className:"font-semibold text-green-600",children:"15.2%"})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{children:"XPS Bonus APR"}),e.jsx("span",{className:"font-semibold text-purple-600",children:"+12.8%"})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold",children:[e.jsx("span",{children:"Total APR"}),e.jsx("span",{className:"text-green-600",children:"28.0%"})]})]}),e.jsx(p,{className:"w-full",size:"lg",onClick:n,disabled:!o||!l||!k||!h||U.isPending,children:U.isPending?"Creating LP Token...":"Create LP Token"})]})]})})]})})]})}export{Je as default};
