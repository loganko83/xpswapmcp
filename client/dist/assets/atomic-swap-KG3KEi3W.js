import{r as c,j as e,H as ne,h as I,a6 as V,aq as ie,f as v,i as $,ar as K,as as le,w as oe,a7 as de}from"./react-vendor-whffYpp3.js";import{u as me,i as xe,a as he,b as z,g as p,C as o,c as d,d as D,e as Q,o as J,B as h,f as ue}from"./index-BkmNh__t.js";import{I as N}from"./input-DXttkvsq.js";import{L as n}from"./label-D6jU-wGE.js";import{S,a as T,b as k,c as A,d as u}from"./select-yBojBFP4.js";import{T as pe,a as je,b as F,c as R}from"./tabs-bZ5-BZyw.js";import{u as q}from"./useMutation-1BHia9Mz.js";import"./vendor-C9R_Cz-L.js";import"./utils-BkLtITBR.js";import"./router-Chclg4Zx.js";import"./ui-DDPZ4K8P.js";import"./web3-DuRBVa1D.js";function fe(){const[U,E]=c.useState("create"),[i,G]=c.useState(null),[w,W]=c.useState(null),[j,P]=c.useState(""),[f,B]=c.useState(""),[L,X]=c.useState("24"),[m,M]=c.useState(""),[y,O]=c.useState(""),{toast:r}=me(),{wallet:x}=xe(),b=he(),{data:g=[]}=z({queryKey:["/api/atomic-swap/tokens"],queryFn:async()=>{const s=await fetch(p("/api/atomic-swap/tokens"));if(!s.ok)throw new Error("Failed to fetch supported tokens");return(await s.json()).data||[]}}),{data:Y=[]}=z({queryKey:["/api/atomic-swap/contracts",x.address],enabled:!!x.address,refetchInterval:5e3,queryFn:async()=>{const s=await fetch(p(`/api/atomic-swap/contracts/${x.address}`));if(!s.ok)throw new Error("Failed to fetch contracts");return(await s.json()).data||[]}}),[ye,ge]=c.useState(null),C=q({mutationFn:async s=>{const a=await fetch(p("/api/atomic-swap/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...s,walletAddress:x.address})});if(!a.ok){const t=await a.json();throw new Error(t.error||"Failed to create atomic swap")}return a.json()},onSuccess:()=>{b.invalidateQueries({queryKey:["/api/atomic-swap/contracts"]}),r({title:"Atomic Swap Created",description:"Your atomic swap contract has been created successfully"}),P(""),B(""),M(""),O(""),E("manage")},onError:s=>{r({title:"Creation Failed",description:s.message,variant:"destructive"})}}),Z=q({mutationFn:async s=>{const a=await fetch(p(`/api/atomic-swap/redeem/${s}`),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({walletAddress:x.address,secret:m})});if(!a.ok){const t=await a.json();throw new Error(t.error||"Failed to redeem contract")}return a.json()},onSuccess:()=>{b.invalidateQueries({queryKey:["/api/atomic-swap/contracts"]}),r({title:"Contract Redeemed",description:"Successfully redeemed the atomic swap contract"})},onError:s=>{r({title:"Redemption Failed",description:s.message,variant:"destructive"})}}),_=q({mutationFn:async s=>{const a=await fetch(p(`/api/atomic-swap/refund/${s}`),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({walletAddress:x.address})});if(!a.ok){const t=await a.json();throw new Error(t.error||"Failed to refund contract")}return a.json()},onSuccess:()=>{b.invalidateQueries({queryKey:["/api/atomic-swap/contracts"]}),r({title:"Contract Refunded",description:"Successfully refunded the atomic swap contract"})},onError:s=>{r({title:"Refund Failed",description:s.message,variant:"destructive"})}}),ee=()=>{const s=new Uint8Array(32);crypto.getRandomValues(s);const a=Array.from(s,l=>l.toString(16).padStart(2,"0")).join("");M(a);const t="0x"+Array.from(a).map(l=>l.charCodeAt(0).toString(16)).join("").slice(0,64);O(t)},se=async()=>{if(!i||!w||!j||!f||!y){r({title:"Missing Information",description:"Please fill in all required fields",variant:"destructive"});return}C.mutate({fromToken:i.symbol,toToken:w.symbol,amount:j,counterpartyAddress:f,lockTime:parseInt(L),hashedSecret:y})},ae=async s=>{if(!m){r({title:"Secret Required",description:"Please enter the secret to redeem the contract",variant:"destructive"});return}Z.mutate(s)},te=async s=>{_.mutate(s)},re=s=>{const t={pending:{color:"bg-yellow-500",icon:V,label:"Pending"},locked:{color:"bg-blue-500",icon:K,label:"Locked"},redeemed:{color:"bg-green-500",icon:I,label:"Redeemed"},refunded:{color:"bg-orange-500",icon:v,label:"Refunded"},expired:{color:"bg-red-500",icon:de,label:"Expired"}}[s],l=t.icon;return e.jsxs(ue,{className:`${t.color} text-white`,children:[e.jsx(l,{className:"w-3 h-3 mr-1"}),t.label]})},H=s=>{navigator.clipboard.writeText(s),r({title:"Copied to Clipboard",description:"Text copied successfully"})},ce=s=>{const a=s-Date.now();if(a<=0)return"Expired";const t=Math.floor(a/(1e3*60*60)),l=Math.floor(a%(1e3*60*60)/(1e3*60));return`${t}h ${l}m`};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Atomic Swaps"}),e.jsx("p",{className:"text-muted-foreground",children:"Trustless cross-chain token exchanges using Hash Time-Locked Contracts (HTLCs)"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(o,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"w-5 h-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Total Swaps"}),e.jsx("p",{className:"text-2xl font-bold",children:"1,247"})]})]})})}),e.jsx(o,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{className:"w-5 h-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Success Rate"}),e.jsx("p",{className:"text-2xl font-bold",children:"98.3%"})]})]})})}),e.jsx(o,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"w-5 h-5 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Avg. Time"}),e.jsx("p",{className:"text-2xl font-bold",children:"12m"})]})]})})}),e.jsx(o,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"w-5 h-5 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Volume 24h"}),e.jsx("p",{className:"text-2xl font-bold",children:"$2.1M"})]})]})})})]}),e.jsxs(pe,{value:U,onValueChange:E,className:"space-y-6",children:[e.jsxs(je,{className:"grid w-full grid-cols-3",children:[e.jsx(F,{value:"create",children:"Create Swap"}),e.jsx(F,{value:"manage",children:"My Contracts"}),e.jsx(F,{value:"discover",children:"Discover"})]}),e.jsx(R,{value:"create",className:"space-y-6",children:e.jsxs(o,{children:[e.jsxs(D,{children:[e.jsx(Q,{children:"Create Atomic Swap"}),e.jsx(J,{children:"Create a trustless cross-chain swap contract"})]}),e.jsxs(d,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"From Token"}),e.jsxs(S,{onValueChange:s=>G(g.find(a=>a.symbol===s)||null),children:[e.jsx(T,{children:e.jsx(k,{placeholder:"Select token to send"})}),e.jsx(A,{children:g.map(s=>e.jsx(u,{value:s.symbol,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:s.icon}),e.jsx("span",{children:s.symbol}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",s.network,")"]})]})},s.symbol))})]}),i&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Balance: ",i.balance," ",i.symbol]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"To Token"}),e.jsxs(S,{onValueChange:s=>W(g.find(a=>a.symbol===s)||null),children:[e.jsx(T,{children:e.jsx(k,{placeholder:"Select token to receive"})}),e.jsx(A,{children:g.filter(s=>s.symbol!==i?.symbol).map(s=>e.jsx(u,{value:s.symbol,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:s.icon}),e.jsx("span",{children:s.symbol}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",s.network,")"]})]})},s.symbol))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Amount"}),e.jsx(N,{type:"number",placeholder:"0.00",value:j,onChange:s=>P(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Lock Time (hours)"}),e.jsxs(S,{value:L,onValueChange:X,children:[e.jsx(T,{children:e.jsx(k,{})}),e.jsxs(A,{children:[e.jsx(u,{value:"12",children:"12 hours"}),e.jsx(u,{value:"24",children:"24 hours"}),e.jsx(u,{value:"48",children:"48 hours"}),e.jsx(u,{value:"72",children:"72 hours"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Counterparty Address"}),e.jsx(N,{placeholder:"0x742d35Cc6e68B4aB8b7C8b8A8Bb7e8Cc9c3D2E1F",value:f,onChange:s=>B(s.target.value)})]}),e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{children:"Secret & Hash"}),e.jsxs(h,{variant:"outline",size:"sm",onClick:ee,children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Generate"]})]}),m&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{className:"text-xs",children:"Secret (Keep Private)"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{value:m,readOnly:!0,type:"password",className:"font-mono text-xs"}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>H(m),children:e.jsx($,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{className:"text-xs",children:"Hash (Public)"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{value:y,readOnly:!0,className:"font-mono text-xs"}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>H(y),children:e.jsx($,{className:"w-4 h-4"})})]})]})]})]}),e.jsx(h,{onClick:se,disabled:C.isPending||!i||!w||!j||!f||!m,className:"w-full",children:C.isPending?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating Contract..."]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Create Atomic Swap"]})})]})]})}),e.jsx(R,{value:"manage",className:"space-y-6",children:e.jsx("div",{className:"space-y-4",children:Y.map(s=>e.jsx(o,{children:e.jsxs(d,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"text-sm font-mono",children:s.id}),re(s.status)]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:ce(s.expiresAt)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Amount & Token"}),e.jsxs("p",{className:"font-medium",children:[s.amount," ",s.token]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Networks"}),e.jsxs("p",{className:"font-medium",children:[s.network," → ",s.counterpartyNetwork]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Counterparty"}),e.jsxs("p",{className:"font-mono text-xs",children:[s.participant.slice(0,10),"..."]})]})]}),s.status==="locked"&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(h,{size:"sm",onClick:()=>ae(s.id),children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Redeem"]}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>te(s.id),children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Refund"]})]})]})},s.id))})}),e.jsx(R,{value:"discover",className:"space-y-6",children:e.jsxs(o,{children:[e.jsxs(D,{children:[e.jsx(Q,{children:"Public Swap Requests"}),e.jsx(J,{children:"Browse available swap requests from other users"})]}),e.jsx(d,{children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(oe,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No public swap requests available"}),e.jsx("p",{className:"text-sm",children:"Check back later for new opportunities"})]})})]})})]})]})}function Ee(){return e.jsx("div",{className:"container mx-auto py-6",children:e.jsx(fe,{})})}export{Ee as default};
