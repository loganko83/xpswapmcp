import{y as H,z as N}from"./vendor-B0r8BCsL.js";import{r as a,u as S}from"./react-CnjVYTDc.js";const U="popstate",y="pushState",P="replaceState",V="hashchange",b=[U,y,P,V],z=e=>{for(const t of b)addEventListener(t,e);return()=>{for(const t of b)removeEventListener(t,e)}},L=(e,t)=>H.useSyncExternalStore(z,e,t),B=()=>location.search,I=({ssrSearch:e=""}={})=>L(B,()=>e),x=()=>location.pathname,M=({ssrPath:e}={})=>L(x,e?()=>e:x),T=(e,{replace:t=!1,state:n=null}={})=>history[t?P:y](n,"",e),$=(e={})=>[M(e),T],C=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[C]>"u"){for(const e of[y,P]){const t=history[e];history[e]=function(){const n=t.apply(this,arguments),s=new Event(e);return s.arguments=arguments,dispatchEvent(s),n}}Object.defineProperty(window,C,{value:!0})}const q=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",w=(e="")=>e==="/"?"":e,G=(e,t)=>e[0]==="~"?e.slice(1):w(t)+e,J=(e="",t)=>q(R(w(e)),R(t)),R=e=>{try{return decodeURI(e)}catch{return e}},_={hook:$,searchHook:I,parser:N,base:"",ssrPath:void 0,ssrSearch:void 0,hrefs:e=>e},j=a.createContext(_),p=()=>a.useContext(j),K={},O=a.createContext(K),Q=()=>a.useContext(O),d=e=>{const[t,n]=e.hook(e);return[J(e.base,t),S((s,c)=>n(G(s,e.base),c))]},ee=()=>d(p()),A=(e,t,n,s)=>{const{pattern:c,keys:i}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",s),u=c.exec(n)||[],[f,...l]=u;return f!==void 0?[!0,(()=>{const r=i!==!1?Object.fromEntries(i.map((m,E)=>[m,l[E]])):u.groups;let o={...l};return r&&Object.assign(o,r),o})(),...s?[f]:[]]:[!1,null]},W=({children:e,...t})=>{const n=p(),s=t.hook?_:n;let c=s;const[i,u]=t.ssrPath?.split("?")??[];u&&(t.ssrSearch=u,t.ssrPath=i),t.hrefs=t.hrefs??t.hook?.hrefs;let f=a.useRef({}),l=f.current,r=l;for(let o in s){const m=o==="base"?s[o]+(t[o]||""):t[o]||s[o];l===r&&m!==r[o]&&(f.current=r={...r}),r[o]=m,m!==s[o]&&(c=r)}return a.createElement(j.Provider,{value:c,children:e})},k=({children:e,component:t},n)=>t?a.createElement(t,{params:n}):typeof e=="function"?e(n):e,X=e=>{let t=a.useRef(K),n=t.current;for(const s in e)e[s]!==n[s]&&(n=e);return Object.keys(e).length===0&&(n=e),t.current=n},te=({path:e,nest:t,match:n,...s})=>{const c=p(),[i]=d(c),[u,f,l]=n??A(c.parser,e,i,t),r=X({...Q(),...f});if(!u)return null;const o=l?a.createElement(W,{base:l},k(s,r)):k(s,r);return a.createElement(O.Provider,{value:r,children:o})},ne=a.forwardRef((e,t)=>{const n=p(),[s,c]=d(n),{to:i="",href:u=i,onClick:f,asChild:l,children:r,className:o,replace:m,state:E,...F}=e,g=S(h=>{h.ctrlKey||h.metaKey||h.altKey||h.shiftKey||h.button!==0||(f?.(h),h.defaultPrevented||(h.preventDefault(),c(u,e)))}),v=n.hrefs(u[0]==="~"?u.slice(1):n.base+u,n);return l&&a.isValidElement(r)?a.cloneElement(r,{onClick:g,href:v}):a.createElement("a",{...F,onClick:g,href:v,className:o?.call?o(s===u):o,children:r,ref:t})}),D=e=>Array.isArray(e)?e.flatMap(t=>D(t&&t.type===a.Fragment?t.props.children:t)):[e],se=({children:e,location:t})=>{const n=p(),[s]=d(n);for(const c of D(e)){let i=0;if(a.isValidElement(c)&&(i=A(n.parser,c.props.path,t||s,c.props.nest))[0])return a.cloneElement(c,{match:i})}return null};export{ne as L,W as R,se as S,te as a,ee as u};
