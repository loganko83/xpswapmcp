# XPSwap 프로젝트 진행 상황 - 2025년 8월 1일

## 🎯 오늘의 작업 목표

### 주요 과제
1. ✅ 메뉴 이동 시 지갑 연결 유지 문제 해결
2. ⏳ Mock 데이터를 실제 블록체인 데이터로 교체
3. ✅ Xphere RPC URL 업데이트 (https://www.ankr.com/rpc/xphere/)
4. ⏳ 로딩 최적화 및 에러 핸들링 개선
5. ⏳ PWA 지원 및 모바일 메타마스크 연결

### 서버 배포 이슈
- API 호출 문제 해결
- Apache 프록시 설정 확인
- 새로고침 시 WordPress 로딩 문제 해결

## 📋 작업 시작 상태

- 로컬 개발 서버 실행 중
  - 백엔드: http://localhost:5000
  - 프론트엔드: http://localhost:5195/xpswap/
- 프로덕션 서버에 배포된 상태이나 일부 기능 미작동

## 🔧 진행된 작업

### 1. 프로젝트 환경 확인
- 진행 상황 디렉토리 생성 완료
- 작업 문서 초기화

### 2. 메뉴 이동 시 지갑 연결 유지 (진행 중)
- 문제점: 페이지 이동 시 메타마스크 연결이 끊어짐
- 원인: 상태 관리 및 라우팅 시 지갑 상태 초기화
- 해결 방법: 전역 상태 관리 개선 필요

### 3. Xphere RPC URL 업데이트
- 기존: https://en-bkk.x-phere.com
- 신규: https://www.ankr.com/rpc/xphere/
- 환경 변수 및 관련 설정 파일 업데이트 예정

## 🚧 다음 작업

1. 지갑 연결 상태 유지 구현
2. RPC URL 전체 교체
3. Mock 데이터 실제 데이터로 변경
4. 에러 핸들링 개선
5. PWA 설정 추가

## 📝 메모

- PowerShell 환경에서 && 대신 ; 사용
- curl 테스트는 CMD 사용 권장
- 서버 배포 시 심볼릭 링크 확인 필요

---

*작업 시작: 2025년 8월 1일 오전*
*최종 업데이트: 진행 중*


## 🔧 진행된 작업 (계속)

### 4. 서버 배포 이슈 해결

#### 문제점
1. API 호출이 CORS 오류로 실패
2. 프론트엔드 티커가 표시되지 않음
3. 메뉴 새로고침 시 WordPress로 리디렉션

#### 해결 과정

1. **Apache 설정 확인 및 수정**
   - `/etc/apache2/sites-available/storydot-kr-unified.conf` 수정
   - XPSwap API 프록시 경로 수정: `/xpswap/api` → `http://localhost:5000/xpswap/api`
   - CORS 헤더 추가:
     ```apache
     Header always set Access-Control-Allow-Origin "*"
     Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
     Header always set Access-Control-Allow-Headers "Content-Type, Authorization"
     ```

2. **빌드 파일 배포**
   - Git pull 후 최신 코드 동기화
   - `npm install --legacy-peer-deps` 실행
   - `npm run build` 실행
   - 빌드된 파일을 `client/dist`로 복사

3. **PM2 프로세스 재시작**
   - `pm2 restart xpswap-api` 실행
   - 서버 상태 확인: 정상 작동

4. **CORS 문제 해결**
   - Apache 레벨에서 CORS 헤더 추가
   - API 응답 확인: `Access-Control-Allow-Origin: *` 헤더 확인

#### 현재 상태
- ✅ API 엔드포인트 정상 작동: https://trendy.storydot.kr/xpswap/api/health
- ✅ 크립토 티커 API 정상: https://trendy.storydot.kr/xpswap/api/crypto-ticker
- ✅ CORS 헤더 설정 완료
- ⏳ 프론트엔드 티커 표시 확인 필요
- ⏳ 메뉴 새로고침 문제 해결 필요

## 🚧 다음 작업

1. 브라우저에서 실제 작동 확인
2. React Router 새로고침 문제 해결
3. 모바일 메타마스크 연결 구현
4. PWA manifest 및 Service Worker 최적화

## 📝 메모

- Apache에서 CORS 헤더를 직접 추가하여 해결
- CSP(Content Security Policy) 설정도 확인 필요
- 빌드 시 청크 파일들이 제대로 생성됨 확인

---

*최종 업데이트: 2025년 8월 1일 오전 8:55*
